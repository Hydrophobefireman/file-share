!function(e){function t(t){for(var r,a,o=t[0],c=t[1],u=t[2],d=0,p=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&p.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);p.length;)p.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(r=!1)}r&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={0:0},s=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;s.push([21,1]),n()}({13:function(e,t,n){e.exports=function(){return new Worker(n.p+"0e3f08016a646afb6f67.worker.js")}},14:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);n(14);var r,i=n(5),s=n.n(i),a=n(4),o=n.n(a),c=n(6),u=n.n(c),l=n(7),d=n.n(l),p=n(0),h=n.n(p),f=n(8),v=n.n(f),m=n(1),y=n.n(m),g=n(2),_=n.n(g),k=n(3),b=n.n(k),x=n(9),w=n.n(x),C=function(e){return e.constructor===Object},S=function(e){if("string"==typeof e)return"/"===e[0]?location.hash=e:location.hash="/".concat(e)},O=new(function(){function e(){_()(this,e),this.EventCache={}}return b()(e,[{key:"emit",value:function(e,t){return window.dispatchEvent(new CustomEvent(e,{detail:t}))}},{key:"listen",value:function(e,t){return this.EventCache[e]=t,window.addEventListener(e,t)}},{key:"detroyEvt",value:function(e,t){window.removeEventListener(e,t)}},{key:"destroyAll",value:function(){for(var e=0,t=Object.keys(this.EventCache);e<t.length;e++){var n=t[e];this.detroyEvt(n,this.EventCache[n])}}}]),e}()),R=function(){},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return v()(Array(e)).join(".").replace(/[.]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},E=((r=document.createElement("style")).innerHTML="",document.head.appendChild(r),r.sheet),j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E,n=Array.from(t.rules);return n.filter((function(t){return t.selectorText===e}))[0]},M=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E,r=Object.keys(t),i=0,s=r;i<s.length;i++){var a=s[i];if(!["$$element","$$parent"].includes(a)){var o=t[a];if("class"===a)e.className="string"==typeof o?o:v()(o).join(" ");else if("events"===a)for(var c=0,u=Object.keys(o);c<u.length;c++){var l=u[c],d=o[l];e.addEventListener(l,d)}else if("style"===a){var p=void 0,h=void 0,f=void 0;if(p=C(o)?H(o):o,f=e.getAttribute("_routercontent")||t._routercontent){var m=j('[_routercontent="'.concat(f,'"]'));m?m.style=p:h=!0}else f=T(),h=!0;h&&(e.setAttribute("_routercontent",f),n.insertRule("[_routercontent='".concat(f,"']{").concat(p,"}")))}else["___innerHTML___","innerText","textContent"].includes(a)?"___innerHTML___"===a?e.innerHTML=o:e.textContent=o:e.setAttribute(a,o)}}},D={q:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?document.querySelector(e):Array.from(document.querySelectorAll(e))},id:function(e){return document.getElementById(e)},className:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Array.from(document.getElementsByClassName(e));return t?n[0]:n},create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E,r=document.createElement(e);return t&&"object"==w()(t)&&M(r,t,n),r},get:function(e,t){return e.getAttribute(t)},set:function(e,t,n){return e.setAttribute(t,n)},empty:function(e){var t;for(t=e.lastChild;t;)e.removeChild(t),t=e.lastChild}},P=function(e){return e instanceof Function},L=function(e){return"AsyncFunction"===e.constructor.name},H=function(e){if("string"==typeof e)return e;for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.push("".concat(i,":").concat(e[i]))}return t.join(";")};var $=function(e){var t=0|e/1048576;if(t)return"".concat(t," MB");var n=0|e/1024;return n?"".concat(n," KB"):"".concat(e," b")},N=function(e,t){if(e){var n=e.routeCache();return n?n[t]:null}return null};function B(e,t){if(!window.customElements.get(e))return window.customElements.define(e,t)}D.q("noscript").remove();var q={element:"a",attrs:{href:"/#/",style:{display:"block",color:"#000"}},events:{click:function(e){e.preventDefault(),location.hash="/"}},textContent:"Click Here to Go Back",children:[]},A={display:"block","text-align":"center","font-family":"sans-serif",padding:"8px",margin:"auto","font-weight":"bold"},I=new(function(){var e,t,n,r;function i(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.$ROOT||D.id("app-root")||D.q("body");_()(this,i),this._setVars(t),window.onhashchange=function(t){return e.navData=t,e.routeChange(),e._runDirectives()},this._runDirectives()}return b()(i,[{key:"parseHash",value:function(e){return function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location;if("#"===t[0])e=t.substr(1);else try{e=new URL(t).hash.substr(1)}catch(t){e="/",console.log(t)}var n=e.split("?"),r=[0===e.length?"/":n[0],n[1]],i=r[0],s=r[1];return{path:i,qs:s}}(e)}},{key:"__runConditionals",value:(n=y()(h.a.mark((function e(){var t,n,r,i,s,a,o,c,u,l,d,p;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=v()(document.querySelectorAll("[_routerif]")),n=!0,r=!1,i=void 0,e.prev=4,s=t[Symbol.iterator]();case 6:if(n=(a=s.next()).done){e.next=27;break}if(o=a.value,c=D.get(o,"_routerif"),u=D.get(o,"_routerthen"),!new Function("$","return ".concat(c)).call(this,o)){e.next=17;break}(l=o.$)&&o.replaceWith(l),u&&new Function("$",u).call(this,l||o),e.next=24;break;case 17:if(!(o.$ instanceof HTMLElement)){e.next=19;break}return e.abrupt("continue",24);case 19:d={_routerif:c},u&&(d._routerthen=u),(p=D.create("router-data",d)).$=o,o.replaceWith(p);case 24:n=!0,e.next=6;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(4),r=!0,i=e.t0;case 33:e.prev=33,e.prev=34,n||null==s.return||s.return();case 36:if(e.prev=36,!r){e.next=39;break}throw i;case 39:return e.finish(36);case 40:return e.finish(33);case 41:case"end":return e.stop()}}),e,this,[[4,29,33,41],[34,,36,40]])}))),function(){return n.apply(this,arguments)})},{key:"__runEventListeners",value:(t=y()(h.a.mark((function e(){var t,n,r,i,s,a,o,c=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=D.q("[_routerEvt][_routerAct]",!1),n=!0,r=!1,i=void 0,e.prev=4,s=function(){var e=o.value,t=D.get(e,"_routerEvt"),n=D.get(e,"_routerAct");e[t]=function(){new Function(n).call(c)}},a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)s();e.next=13;break;case 9:e.prev=9,e.t0=e.catch(4),r=!0,i=e.t0;case 13:e.prev=13,e.prev=14,n||null==a.return||a.return();case 16:if(e.prev=16,!r){e.next=19;break}throw i;case 19:return e.finish(16);case 20:return e.finish(13);case 21:case"end":return e.stop()}}),e,null,[[4,9,13,21],[14,,16,20]])}))),function(){return t.apply(this,arguments)})},{key:"_runDirectives",value:(e=y()(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.__runConditionals();case 2:this.__runEventListeners();case 3:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"_callFuncWithThis",value:function(e,t,n,r){if(L(e))return e.apply(t,[r]).then((function(e){return n&&(e||{}).stopUpdate&&M(n,t.attrs),e}));var i=e.apply(t,[r]);return n&&((i||{}).stopUpdate||M(n,t.attrs)),i}},{key:"_setVars",value:function(e){var t=this;this.stopSubsequentRenders=!1,this.root=e,this.routeMap={},this.routes=[],this.routeCache={},this.unMountFn=function(){},this.unmountRoute=function(){t.unMountFn(),t.routeCache={}},this.statusHandler={404:{element:"div",attrs:{style:A},textContent:"The Page you are requesting was not found",children:[q]},500:{element:"div",attrs:{style:A},textContent:"An Error Occured while trying to process your request",children:[q]}}}}]),b()(i,[{key:"isUserGoingBack",value:function(e){var t=this.navData||{};return!("".concat(location.protocol,"//").concat(location.host,"/#").concat(e)!=t.oldURL||(console.log("Same url navigation"),0))}},{key:"routeParser",value:function(e){return this.parseHash(e).path}},{key:"load",value:function(e){return S(e)}},{key:"lazyload",value:function(e,t,n){var r=this;n?this.registerRoute(n):this.registerRoute({route:e,element:"div",textContent:"loading",attrs:{style:{margin:"100px"}}});var i=this.getRouteName(this.currentRoute)===e;return i&&this.startLoad(),t.then((function(e){if(r.registerRoute(e.default),i)return r.startLoad()}))}},{key:"startLoad",value:function(){this.routeChange()}},{key:"pushStatus",value:function(e,t){var n=this.statusHandler[e];return n.textContent=t||n.textContent,n?this.render(n,this.root,!0):this.render(this.statusHandler[404])}},{key:"getRouteName",value:function(e){var t=e.split("/").filter((function(e){return e}))[0];return t?"/".concat(t,"/"):"/"}},{key:"isValidRoute",value:function(e){if(this.routes.includes(e))return{res:!0,args:null,_fRoute:e};try{var t=e.split("/").filter((function(e){return e})),n="/".concat(t[0],"/");return this.routes.includes(n)?{res:!0,args:t.slice(1),_fRoute:n}:{res:!1}}catch(t){return console.log(t),{res:!1}}}},{key:"routeChange",value:function(){var e=this.parseHash(location.href),t=this.isValidRoute(e.path),n=t.res,r=t.args,i=t._fRoute;n?(console.log("rendering"),this.render(this.routeMap[i],this.root,!0,{args:r,qs:e.qs})):this.render(this.statusHandler[404],this.root,!0,r)}},{key:"__toSets",value:function(e){"string"==typeof e.attrs.class?e.attrs.class=new Set([e.attrs.class]):Array.isArray(e.attrs.class)&&(e.attrs.class=new Set(e.attrs.class))}},{key:"__objDef",value:function(e,t,n,r,i){var s=this,a=function(){return e.$$element};e.attrs=e.attrs||{},this.__toSets(e),e.getRouter=function(){return s},e.update=function(){if(a()&&e.attrs)return M(a(),e.attrs)},e.remove=function(){if(a().parentNode)return a().replaceWith(function(){var t=D.create("router-data");return e._$routerData=t,t}())},e.add=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";e._$routerData&&(e._$routerData.replaceWith(a()),e._$routerData=void 0),t&&(a().style.display=t)},e.routeCache=function(){return s.routeCache},e.reRender=y()(h.a.mark((function o(){var c,u=arguments;return h.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=u.length>0&&void 0!==u[0]?u[0]:e,e.attrs._routercontent=a().getAttribute("_routercontent"),o.t0=a(),o.next=5,s.render(c,t,n,r,i);case 5:return o.t1=o.sent,o.abrupt("return",o.t0.replaceWith.call(o.t0,o.t1));case 7:case"end":return o.stop()}}),o)}))),e.safeRerender=function(t){e.add(),e.reRender(t),e.add()}}},{key:"render",value:(r=y()(h.a.mark((function e(t,n){var r,i,s,a,o,c,u,l,d,p,f,v,m,y,g,_,k,b,x,w,C,S,O,R,T,E,j,M=this,H=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=H.length>2&&void 0!==H[2]&&H[2],i=H.length>3?H[3]:void 0,s=H.length>4?H[4]:void 0,!this.stopSubsequentRenders&&t){e.next=6;break}return console.log("preventing render"),e.abrupt("return");case 6:if("string"!=typeof t){e.next=9;break}return a=document.createTextNode(t),e.abrupt("return",(n.appendChild(a),a));case 9:if(o=i||{},this._runDirectives(),c=t.element,u=t.attrs,l=t.beforeRender,d=t.onrender,p=t.textContent,f=t._innerHTML,v=t.onUnmount,m=t.events,y=t.children,g=t.isRoute,this.__objDef(t,n,r,o,s),(g||r)&&this.unmountRoute(),!P(l)){e.next=24;break}if(!L(l)){e.next=21;break}return e.next=18,this._callFuncWithThis(l,t,null,o);case 18:_=e.sent,e.next=22;break;case 21:_=this._callFuncWithThis(l,t,null,o);case 22:if(!_||!_.stopExec){e.next=24;break}return e.abrupt("return");case 24:for(k=D.create(c,u),b={},t.idx&&(b[t.idx]=t),Object.assign(this.routeCache,F(y),b),t.$$element=k,t.$$parent=s||null,p||0===p?k.textContent=p:f&&(console.warn("innerHTML can be dangerous!"),k.innerHTML=f),x=function(){var e=C[w];k.addEventListener(e,(function(n){return M._callFuncWithThis(m[e],t,k,n)}))},w=0,C=Object.keys(m||{});w<C.length;w++)x();for(S=!0,O=!1,R=void 0,e.prev=36,T=(y||[])[Symbol.iterator]();!(S=(E=T.next()).done);S=!0)j=E.value,this.render(j,k,!1,null,t);e.next=44;break;case 40:e.prev=40,e.t0=e.catch(36),O=!0,R=e.t0;case 44:e.prev=44,e.prev=45,S||null==T.return||T.return();case 47:if(e.prev=47,!O){e.next=50;break}throw R;case 50:return e.finish(47);case 51:return e.finish(44);case 52:if(r&&D.empty(n),n.appendChild(k),g&&(this.unMountFn=v||function(){}),!P(d)){e.next=62;break}if(!L(d)){e.next=61;break}return e.next=59,this._callFuncWithThis(d,t,k,o);case 59:e.next=62;break;case 61:this._callFuncWithThis(d,t,k,o);case 62:return e.abrupt("return",k);case 63:case"end":return e.stop()}}),e,this,[[36,40,44,52],[45,,47,51]])}))),function(e,t){return r.apply(this,arguments)})},{key:"registerRoute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(e.route&&e.element&&"/"===e.route[0]||t))throw new Error("invalid values");if(!t){this.routes.includes(e.route)||this.routes.push(e.route);var n=e.element,r=e.children,i=e.selector,s=e.attrs,a=e.beforeRender,o=e.events,c=e.hasRouteArgs,u=e.onUnmount,l=e.onrender,d=e.route,p=e.textContent,h=e._innerHTML,f=e.idx;return this.routeMap[d]={idx:f,element:n,selector:i,beforeRender:a,onrender:l,hasRouteArgs:c,attrs:s,textContent:p,_innerHTML:h,events:o,children:r,onUnmount:u,isRoute:!0}}var v=e.status;this.statusHandler[v]=e}},{key:"currentQS",get:function(){return this.parseHash(location.hash).qs}},{key:"currentRoute",get:function(){return this.routeParser(location.href)}}]),i}());function F(e){if(!e)return{};var t={},n=!0,r=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var o=s.value;o.idx&&(t[o.idx]=o)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}B("router-data",function(e){function t(){var e;return _()(this,t),(e=s()(this,o()(t).call(this))).attachShadow({mode:"open"}).appendChild(Object.assign(document.createElement("style"),{innerHTML:":host{display:none}"})),e}return u()(t,e),t}(d()(HTMLElement)));var z=function(){var e=y()(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",((n=document.createElement("link")).href=t,n.rel="stylesheet",document.head.appendChild(n)));case 4:e.prev=4,e.t0=e.catch(0),console.log("Could not append stylesheet",e.t0);case 7:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(t){return e.apply(this,arguments)}}(),J=n(10),U=n.n(J);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G,K=(G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i={};return t.blur||(i.blur=function(){(function(e,t){if(!e.attrs.value||!e.attrs.value.trim()){var n=N(e,t);n.attrs.class.delete("moveup"),n.attrs.class.add("movedown"),n.update(),setTimeout((function(){return n.attrs.class.delete("movedown"),n.update()}),110)}})(this,r),this.update()}),t.focus||(i.focus=function(){this.attrs.untouched=!1,function(e,t){var n=N(e,t);n.attrs.class.add("moveup"),n.attrs.class.delete("movedown"),n.update()}(this,r)},!t.keydown&&(i.keydown=function(e){85===e.keyCode&&e.ctrlKey&&(e.preventDefault(),this.$$element.value=this.$$element.value.slice(this.$$element.selectionStart,this.$$element.value.length),this.$$element.setSelectionRange(0,0))}),!t.keyup&&(i.keyup=function(){return this.attrs.value=this.$$element.value})),{idx:e,element:"input",attrs:{type:n?"password":"text",spellcheck:!1,class:"paper-input"},onrender:function(){this.attrs.value?this.$$element.focus():(this.attrs.untouched=!0,this.attrs.clean=!0)},events:V({},t,{},i)}},function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return{element:"div",children:[{idx:e,onrender:function(){var e=N(this,n);e&&e.$$element&&e.$$element.value.trim()&&(this.attrs.class=new Set(["_animate","moveup"]))},element:"div",textContent:t,attrs:{class:"_animate"}},G(n,r,i,e)]}}),Y=n(12),Q=n.n(Y),X="size",Z=document.createElement("template");Z.innerHTML='<style>.spinner{margin:auto;height: 50px; width: 50px; animation: rotate 0.8s infinite linear; border: 6px solid #e3e3e3; border-right-color: var(--primary-color); border-radius: 50%;}@keyframes rotate{from{transform: rotate(0deg);}to{transform: rotate(360deg);}}</style><div class="spinner"></div>';var ee=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;Object.defineProperty(e,n,{enumerable:!0,get:function(){var e=this.getAttribute(t);return null===e?"":e},set:function(e){this.setAttribute(t,e)}})},te=function(e){function t(){var e;_()(this,t),e=s()(this,o()(t).call(this));var n=Z.content.cloneNode(!0),r=e.attachShadow({mode:"open"});return r.appendChild(n),ee(Q()(e),X),e.div=r.querySelector(".spinner"),e}return u()(t,e),b()(t,[{key:"attributeChangedCallback",value:function(e,t,n){if(e===X&&n!==t){var r=this.div.style;r.height=r.width="string"==typeof n&&n.includes("px")?n:"".concat(n,"px")}}}],[{key:"observedAttributes",get:function(){return[X]}}]),t}(d()(HTMLElement));B("mat-spinner",te);var ne=window.location.host.includes("localhost")?"localhost:5000":"file-share-rtc.herokuapp.com";function re(e,t){return new Promise((function(n){e.addEventListener(t,n,{once:!0})}))}var ie="".concat(window.location.protocol,"//").concat(ne),se=function(e){try{return btoa(JSON.stringify(e))}catch(e){return console.warn(e),null}},ae=function(e){try{return JSON.parse(atob(e))}catch(e){return console.warn(e),null}},oe=function(){function e(){_()(this,e)}var t,n;return b()(e,null,[{key:"get",value:(n=y()(h.a.mark((function e(t){var n,r,i,s=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(s.length>1&&void 0!==s[1])||s[1],r=s.length>2&&void 0!==s[2]?s[2]:{},i=n?ie+t:t,e.next=5,fetch(i,{headers:r,credentials:"include"});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"post",value:(t=y()(h.a.mark((function e(t){var n,r,i,s,a=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],r=a.length>2?a[2]:void 0,i=a.length>3&&void 0!==a[3]?a[3]:{"content-type":"application/x-www-form-urlencoded"},s=n?ie+t:t,e.next=6,fetch(s,{method:"post",body:r,headers:i,credentials:"include"});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}();function ce(e,t){return ue.apply(this,arguments)}function ue(){return(ue=y()(h.a.mark((function e(t,n){var r,i,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){var e=y()(h.a.mark((function e(){var n,r=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(r.length>0&&void 0!==r[0])||r[0],t.stopSubsequentRenders=!1,D.empty(t.root),t.root.appendChild(new te(null,null,H({margin:"auto",position:"fixed",top:0,bottom:0,left:0,right:0}))),t.root.appendChild((i=void 0,(i=D.create("div",{style:"margin:auto;text-align:center"})).textContent="Connecting to the server",i)),e.next=7,oe.get("/api/gen_204");case 7:setTimeout((function(){return n?t.startLoad():void 0}),450);case 8:case"end":return e.stop()}var i}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(e){return{element:"div",status:503,textContent:"An error occured while contacting the server..please reload the page and try again",attrs:{style:{margin:"auto","text-align":"center"},class:"_errComponent"},children:[{element:"button",attrs:{style:{background:"#fff",color:"#000",border:"1px solid #6f70ee","border-radius":"20px",display:"block",margin:"auto","margin-top":"20px",padding:"8px",width:"20%",outline:"none",cursor:"pointer"},class:"ripple"},textContent:"Reload",events:{click:function(){return ce(e)}}}]}},s=function(e,t){return console.log(e),t.registerRoute(i(t),!0),setTimeout((function(){return t.pushStatus(503),t.stopSubsequentRenders=!0}),500)},e.abrupt("return",le((function(){return r(n)}),2,(function(e){return s(e,t)})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var le=function(){var e=y()(h.a.mark((function e(t,n,r){var i,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=0;case 1:if(!(s<n)){e.next=16;break}return e.prev=2,e.next=5,t();case 5:return e.abrupt("return",e.sent);case 8:e.prev=8,e.t0=e.catch(2),i=e.t0;case 11:return e.next=13,new Promise((function(e){setTimeout((function(){return e()}),100)}));case 13:s++,e.next=1;break;case 16:r(i);case 17:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n,r){return e.apply(this,arguments)}}(),de="".concat(navigator.platform,"-").concat(navigator.product,"-").concat(T(5)),pe={element:"div",onrender:function(){var e=N(this,"deviceID"),t=N(this,"deviceID-ph");t.attrs.class.add("moveup"),e.attrs.value=de,e.reRender(),t.reRender()},children:["Type Your Device Name",K("deviceID-ph","Device Name","deviceID")]};function he(e,t){var n=N(t,"notif");return n.$$element.style.transform="translate(0px,0px)",n.$$element.textContent=e,setTimeout((function(){return n.reRender()}),2e3)}function fe(e,t){return ve.apply(this,arguments)}function ve(){return(ve=y()(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(n,"$spinner").add(),e.next=4,oe.post("/api/validate-id/",!0,JSON.stringify({sess_id:t}),{"content-type":"application/json"});case 4:return r=e.sent,e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(){return(me=y()(h.a.mark((function e(t){var n,r,i,s,a,o,c,u,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.keyCode,r=this.attrs.value||"",!(i=r.trim())||13!==n){e.next=34;break}return e.next=6,fe(i,this);case 6:if("unique"!==e.sent.type){e.next=11;break}he("No Session exists with the given ID",this),e.next=33;break;case 11:return s=N(this,"deviceID").attrs.value,e.next=14,oe.post("/api/get-id/",!0,JSON.stringify({sess_id:i,device_id:s,default_token:de}),{"content-type":"application/json"});case 14:return a=e.sent,e.next=17,a.json();case 17:if(o=e.sent,!((u=o.init_conn).length-1)){e.next=25;break}return e.next=22,getPreferredUser();case 22:c=e.sent,e.next=26;break;case 25:c=u[0];case 26:if("no_id"!==o.type){e.next=30;break}return e.abrupt("return",he("An error occured while connecting..please start a new session",this));case 30:if(!(l=se({id:i,device_id:s,preferred:c}))){e.next=33;break}return e.abrupt("return",S("/session?".concat(l)));case 33:return e.abrupt("return",N(this,"$spinner").remove());case 34:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function ye(e){return ge.apply(this,arguments)}function ge(){return(ge=y()(h.a.mark((function e(t){var n,r,i,s,a,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.keyCode,r=this.attrs.value||"",!(i=r.trim())||13!==n){e.next=26;break}return e.next=6,fe(i,this);case 6:if("unique"!==e.sent.type){e.next=24;break}return s=N(this,"deviceID").attrs.value,e.next=11,oe.post("/api/set-id/",!0,JSON.stringify({sess_id:i,device_id:s,default_token:de}),{"content-type":"application/json"});case 11:return a=e.sent,e.next=14,a.json();case 14:if("init_connection"!==e.sent.type){e.next=21;break}if(!(o=se({id:i,device_id:s}))){e.next=19;break}return e.abrupt("return",S("/session?".concat(o)));case 19:e.next=22;break;case 21:he("Invalid Data",this);case 22:e.next=25;break;case 24:he("A Session already exists with that name",this);case 25:return e.abrupt("return",N(this,"$spinner").remove());case 26:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var _e={idx:"startsessbtn",element:"button",attrs:{style:{"border-radius":"5px",margin:"10px"},class:["ripple","actionbtn"]},children:["Start a Session"],events:{click:function(){var e=N(this,"joinSessBox"),t=N(this,"startSessBox");e.remove(),t.add("")}}},ke={idx:"joinsessbtn",element:"button",attrs:{style:{"border-radius":"5px",margin:"10px"},class:["ripple","actionbtn"]},children:["Join a Session"],events:{click:function(){var e=N(this,"joinSessBox"),t=N(this,"startSessBox");e.add(""),t.remove()}}},be={idx:"joinSessBox",onrender:function(){this.remove()},element:"div",children:[{element:"div",children:["Type a session name to join"]},K("joinID-ph","Session ID","joinID",{keydown:function(e){return me.apply(this,arguments)}})]};console.log(K("startID-ph","Session ID","startID",{keydown:ye}));var xe,we={route:"/",element:"div",attrs:{},children:[{element:"div",idx:"notif",attrs:{notification:""}},pe,_e,ke,be,{onrender:function(){this.remove()},children:[{element:"div",children:["Type a session name to start. Others will find your device with this name"]},K("startID-ph","Session ID","startID",{keydown:ye})],idx:"startSessBox",element:"div"},{element:"mat-spinner",idx:"$spinner",onrender:function(){this.remove()},attrs:{svgstyle:"margin:auto;display:block"}}]},Ce=function(){function e(){_()(this,e)}return b()(e,[{key:"__defaultOnMessage",value:function(e){if(!["ping","pong"].includes(e.data)){var t=JSON.parse(e.data);this._socketID=t.socket_id}}},{key:"startConn",value:function(e){var t=this;return new Promise((function(n,r){t.socket=new WebSocket(function(e){return"".concat("https:"===window.location.protocol?"wss://":"ws://").concat(ne,"/").concat(e)}(e)),t.socket.onopen=function(){t.socket.onmessage=t.__defaultOnMessage,t._pingPongs(),n(t.socket)},t.socket.onerror=function(e){return r(e)}}))}},{key:"close",value:function(){try{this.socket.close()}catch(e){console.warn(e)}}},{key:"send",value:function(e){return this.socket.send(JSON.stringify(e))}},{key:"sendString",value:function(e){return this.socket.send(e)}},{key:"_pingPongs",value:function(){var e=this;this.pingtimer=setTimeout((function(){e.socket.readyState===e.socket.OPEN?(e.send({type:"ping"}),e._pingPongs()):clearTimeout(e.pingtimer)}),2e4)}},{key:"onmessage",set:function(e){this.socket.onmessage=function(t){var n=JSON.parse(t.data||"{}");return"ping"===n.type||"pong"===n.type?void 0:e(n)}}},{key:"readyState",get:function(){return this.socket.readyState}},{key:"isUsable",get:function(){return!this.socket||[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)}}]),e}(),Se=function(){return(xe||{}).isUsable?xe:xe=new Ce},Oe="div[full]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.61);z-index:10;padding:16px}div[header],input{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}div[header]{font-weight:700;user-select:none}div[message],div[area]{-webkit-box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);z-index:3;background:#fff;border-radius:8px;width:100%;padding:16px;max-width:500px}input,span{display:inline-block}input{user-select:none;background-color:#f5f5f5;padding:12px;margin-top:20px;margin-bottom:20px;width:95%;border:none;outline:0;border-radius:50px}span:hover{background-color:#d2d2d2}span{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:60px;text-align:center;padding:6px;cursor:pointer;border-radius:8px;color:var(--primary-color)}";var Re=n(13);function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(n,!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var je,Me=new(n.n(Re).a),De=(je={_handlers:{},worker:null},new(function(){function e(t){_()(this,e),je.worker=t,this.onmessage=this.onmessage.bind(this),je.worker.onmessage=this.onmessage}return b()(e,[{key:"setHandler",value:function(e,t){je._handlers[e]=t}},{key:"onmessage",value:function(e){var t=e.data,n=t.type,r=t.data,i=je._handlers[n];if(i)return i(r);console.log("Worker Said:",r)}},{key:"handlers",get:function(){return je._handlers}}]),e}())(Me)),Pe=function(){var e=y()(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Response(t).arrayBuffer();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){var e;function t(){_()(this,t),this.chunkBuffer=this.chunkBuffer.bind(this),this._buffer=[]}return b()(t,[{key:"chunkBuffer",value:function(e){this._buffer.push(e.fileChunk),e.over&&(this._fn({bufferChunk:this._buffer,data:this._meta}),O.emit("file-sent"))}},{key:"chunk",value:(e=y()(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._buffer=[],this._fn=n,e.next=4,Pe(t);case 4:r=e.sent,this._meta={type:t.type,name:t.name,size:t.size,id:T(15)},Me.postMessage({data:Ee({file:r},this._meta),type:"file-chunk"},[r]),De.setHandler("chunked-file",this.chunkBuffer);case 8:case"end":return e.stop()}}),e,this)}))),function(t,n){return e.apply(this,arguments)})}]),t}(),He=function(){var e;function t(){var e=this;_()(this,t),this.mergeBuffer=this.mergeBuffer.bind(this),this._buffer=[],this._currentBufferByteSize=0,De.setHandler("merged-file",this.mergeBuffer),De.setHandler("merge-progress",(function(t){var n=t.done;return e._currentBufferByteSize=n}))}return b()(t,[{key:"mergeBuffer",value:function(e){var t=this;console.log("final File:"),Promise.resolve(this._onFullFile(e)).then((function(){return t._buffer=[],t._currentBufferByteSize=0}))}},{key:"merge",value:(e=y()(h.a.mark((function e(t,n,r){var i,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.file,s=t.data,this._onFullFile=r,this._meta=s,Promise.resolve(this._currentBufferByteSize).then(n||R),Me.postMessage({data:i,type:"file-merge"},[i]);case 5:case"end":return e.stop()}}),e,this)}))),function(t,n,r){return e.apply(this,arguments)})},{key:"complete",value:function(){Me.postMessage({type:"complete",data:this._meta})}}]),t}(),$e="<style>div[area],span{border-radius:8px}div[full]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.61);z-index:10;padding:16px}div[area]{-webkit-box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);z-index:3;background:#fff;width:100%;padding:16px;max-width:500px}div[header]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;font-weight:700;user-select:none}div[progress]{margin:auto;transition:0.2s;height:20px;background-color:var(--primary-color);border-radius:20px;}span{display:inline-block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:60px;text-align:center;padding:6px;cursor:pointer;color:var(--primary-color)}a{color:unset;text-decoration:none;}</style>",Ne=function(e){function t(e,n,r){var i;_()(this,t),(i=s()(this,o()(t).call(this)))._done=e||0,i._total=n||100,i._str=r||"";var a="".concat($e,"<div full><div area><div header></div><div progress></div><div><span progress-text></span></div></div></div>"),c=document.createElement("template");c.innerHTML=a;var u=i.attachShadow({mode:"open"});return u.appendChild(c.content.cloneNode(!0)),i._header=u.querySelector("div[header]"),i._progressDiv=u.querySelector("div[progress]"),i._progressText=u.querySelector("span[progress-text]"),i}return u()(t,e),b()(t,[{key:"connectedCallback",value:function(){this._render()}},{key:"_render",value:function(){this._header.textContent=this._str;var e=(this._done/this._total*100).toFixed(2),t="".concat(Math.min(e,100),"%");this._progressDiv.style.width=t,this._progressText.textContent="".concat(t," ").concat($(this._done)," of ").concat($(this._total))}},{key:"setValues",value:function(e,t,n){this._total=t,this._done=e,this._str=n,this._render()}}]),t}(d()(HTMLElement)),Be=Ne,qe=function(e){function t(e,n){var r;_()(this,t),r=s()(this,o()(t).call(this));var i="".concat($e,"<div full><div area><div header></div><div download></div><div size></div><span cancel>Cancel</span><span download><a>Download</a></span></div></div>");r._url=e;var a=document.createElement("template");a.innerHTML=i;var c=r.attachShadow({mode:"open"});return c.appendChild(a.content.cloneNode(!0)),r._header=c.querySelector("div[header]"),r._download=c.querySelector("div[download]"),r.__size=c.querySelector("div[size]"),r.dlButton=c.querySelector("a"),r.cancelBTN=c.querySelector("span[cancel]"),c.querySelector("div[area]").onclick=function(e){return e.stopPropagation()},r._meta=n||{},r}return u()(t,e),b()(t,[{key:"connectedCallback",value:function(){var e=this;this._header.textContent="Download Ready",this._download.textContent="Filename:".concat(this._meta.name),this.__size.textContent="Size:".concat($(this._meta.size)),this.cancelBTN.onclick=function(){return e.remove()},this.dlButton.href=this._url,this.dlButton.download=this._meta.name}}]),t}(d()(HTMLElement));var Ae=new Le,Ie=new He;function Fe(){try{for(var e=document.getElementById("logger-area"),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,s=n;i<s.length;i++){var a=s[i];e.appendChild(document.createTextNode(C(a)?JSON.stringify(a):a))}return e.innerHTML+="&#13;&#10;",console.log.apply(this,n)}catch(e){}}B("file-download",qe),B("file-progress",Ne),B("text-input",function(){var e={onsend:null,innerHTML:"<style>".concat(Oe,'</style><div full><div area><div header>Send a Message</div><input spellcheck="false" placeholder="Send a Message" type="text"><span send-button>Send</span><span cancel-button>Cancel</span></div></div>')};return function(t){function n(){var t;_()(this,n),t=s()(this,o()(n).call(this));var r=document.createElement("template");r.innerHTML=e.innerHTML;var i=t.attachShadow({mode:"open"});return i.appendChild(r.content.cloneNode(!0)),i.querySelector("div[area]").onclick=function(e){return e.stopPropagation()},i.querySelector("div[full]").onclick=function(){return t.remove()},e.input=i.querySelector("input"),t.focus=function(){return e.input.focus()},e.input.addEventListener("keydown",(function(e){13===e.keyCode&&t.onsend&&t.onsend(t.value)})),i.querySelector("span[cancel-button]").onclick=function(){return t.remove()},t}return u()(n,t),b()(n,[{key:"value",get:function(){return e.input.value},set:function(t){return e.input.value=t}},{key:"onsend",set:function(t){var n=this;e.onsend=t,this.shadowRoot.querySelector("span[send-button]").addEventListener("click",(function(){return t(n.value)}))},get:function(){return e.onsend}}]),n}(d()(HTMLElement))}()),B("text-received",function(){var e={innerHTML:"<style>".concat(Oe,"</style><div full><div message><div header>Received Message</div><input message-content readonly><span>Okay</span></div>")};return function(t){function n(t){var r;_()(this,n),r=s()(this,o()(n).call(this));var i=document.createElement("template");i.innerHTML=e.innerHTML;var a=r.attachShadow({mode:"open"});return a.appendChild(i.content.cloneNode(!0)),e.message=a.querySelector("input[message-content]"),e.message.value=t||"",a.querySelector("div[message]").onclick=function(e){return e.stopPropagation()},a.querySelector("span").onclick=a.querySelector("div[full]").onclick=function(){return r.remove()},r}return u()(n,t),b()(n,[{key:"data",set:function(t){e.message.value=t||this.data||""},get:function(){return e.message.value}}]),n}(d()(HTMLElement))}());var ze={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]};function Je(e,t){var n=D.create("div",{notification:"",textContent:e});return document.body.appendChild(n),setTimeout((function(){return n.style.transform="translate(0px,0px)",setTimeout((function(){return n.remove()}),t||2e3)}),300)}var Ue=function(){var e,t,n,r;function i(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Se();_()(this,i),O.listen("unmount-route",this._onUnmount),this._sess_id=e,this._peer=t,this._content=n,this._socket=r,this._isOfferer=void 0,this._reportHook=document.getElementById("reporthooks"),this.__reportProgress=this.__reportProgress.bind(this),this._dcOnMessage=this._dcOnMessage.bind(this),this._ondatachannel=this._ondatachannel.bind(this),this._wsOnMessage=this._wsOnMessage.bind(this),this._onUnmount=this._onUnmount.bind(this),this._sendJSON=this._sendJSON.bind(this),this._startConn=this._startConn.bind(this),this._socketError=this._socketError.bind(this),this._sendPartialFile=this._sendPartialFile.bind(this),this._socket.startConn("socket-conn/").then(this._startConn).catch(),this._messageHooks={"chunk-ready":function(e){return O.emit("chunk-ready",e)}}}return b()(i,[{key:"_closeRTCConn",value:function(){try{return this._pc.close()}catch(e){}this._pc=this._dc=null}},{key:"_onIceCandidate",value:function(e){if(e&&this._pc)return this._socket.send({type:"rtc_data",data:{icecandidate:e,sess_id:this._sess_id}})}},{key:"_iceStateChange",value:(r=y()(h.a.mark((function e(){var t,n,r,i,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._pc.iceConnectionState,["closed","disconnected","failed"].includes(t)&&(Fe("Connection is Dead.."),(n=document.querySelector("file-progress"))&&n.remove(),(r=document.querySelector("file-download"))&&r.remove(),i=document.getElementById("file-send"),s=document.getElementById("message-send"),i&&(s.style.display="none",i.style.display="none"),this.__updateReport__("Connection is dead"),Je("connection lost.retrying"),this._pc=this._isOfferer=null);case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"_wsOnMessage",value:(n=y()(h.a.mark((function e(t){var n,r,i,s,a,o,c,u=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Fe("[WS]",t),n=t.type,r=t.data,i=void 0===r?{}:r,"conn_data"!==n){e.next=29;break}if(this._pc&&(Fe("[DEBUG]Removing previous connection"),this.__updateReport__("removing previous connection")),this._closeRTCConn(),this._pc=this._dc=this._isOfferer=null,!i.peer||!i.peer_device||this._pc){e.next=27;break}if(this._pc=new RTCPeerConnection(ze),this._pc.onicecandidate=function(e){var t=e.candidate;return Fe("[RTC]Ice Candidate"),u.__updateReport__("received ice candidate"),u._onIceCandidate(t)},this._pc.oniceconnectionstatechange=function(e){return u._iceStateChange(e)},this._isOfferer=i.is_offerer,!this._isOfferer){e.next=24;break}return Fe("[RTC]creating offer"),this.__updateReport__("creating offer"),this._dc=this._pc.createDataChannel(T()),this._dc.onmessage=function(e){if("init"===e.data)return Fe("[RTC]Data Channel Ready",u._dc),u.__updateReport__("data channel ready!"),u._startMainSess()},e.next=18,this._pc.createOffer();case 18:return s=e.sent,e.next=21,this._pc.setLocalDescription(s);case 21:return e.abrupt("return",this._socket.send({type:"rtc_data",data:{rtc:"offer",js:s,sess_id:this._sess_id}}));case 24:return Fe("[RTC]awaiting offer"),this.__updateReport__("Waiting offer"),e.abrupt("return",this._pc.ondatachannel=function(e){var t=e.channel;return u._ondatachannel(t)});case 27:e.next=65;break;case 29:if("rtc_data"!==n){e.next=65;break}if(a=i.rtc,o=i.js,!(c=i.icecandidate)||!this._pc){e.next=44;break}return e.prev=32,Fe("[RTC]Recieved Candidate"),this.__updateReport__("received candidate"),e.next=37,this._pc.addIceCandidate(c);case 37:return e.abrupt("return",e.sent);case 40:e.prev=40,e.t0=e.catch(32),Fe("[RTC]Could not add ice candidate"),this.__updateReport__("could not add ice candidate");case 44:if("offer"!==a||this._isOfferer){e.next=60;break}return Fe("[RTC]Recieved offer"),this.__updateReport__("recieved offer"),e.next=49,this._pc.setRemoteDescription(o);case 49:return Fe("[RTC]Creating Answer"),this.__updateReport__("creating answer"),e.t1=this._pc,e.next=54,this._pc.createAnswer();case 54:return e.t2=e.sent,e.next=57,e.t1.setLocalDescription.call(e.t1,e.t2);case 57:return e.abrupt("return",this._socket.send({type:"rtc_data",data:{rtc:"answer",js:this._pc.localDescription,sess_id:this._sess_id}}));case 60:if("answer"!==a){e.next=65;break}return Fe("[RTC]Received Answer"),this.__updateReport__("Received answer"),e.next=65,this._pc.setRemoteDescription(o);case 65:case"end":return e.stop()}}),e,this,[[32,40]])}))),function(e){return n.apply(this,arguments)})},{key:"_ondatachannel",value:function(e){return this._dc=e,this._sendRaw("init"),Fe("[RTC] Recieved Data Channel",e),this.__updateReport__("data channel ready!"),this._startMainSess()}},{key:"_sendRaw",value:function(e){if(this._dc)return this._dc.send(e)}},{key:"_sendJSON",value:function(e){return this._sendRaw(JSON.stringify(e))}},{key:"__reportProgress",value:function(e,t,n){var r="".concat(e?"sending":"receiving"," File");this._progressElement=this._progressElement||new Be(0,0,r),this._progressElement.isConnected||this._content.$$element.appendChild(this._progressElement),this._progressElement.setValues(t,n,r)}},{key:"_startMainSess",value:function(){var e=this;this._reportHook.textContent="Connected to ".concat(this._peer),this._dc.onmessage=this._dcOnMessage,this._messageHooks["file-chunk"]=function(t){e._fileMeta=t,console.log("ready for next chunk"),e._sendJSON({type:"chunk-ready",data:t})},this._messageHooks.complete=Ie.complete.bind(Ie);var t=document.getElementById("file-send"),n=document.getElementById("message-send");t.style.display="block",n.style.display="block",n.onclick=function(){return t=function(t){return e._sendJSON({type:"text-message",data:t})},n=D.create("text-input"),document.body.appendChild(n),n.focus(),void(n.onsend=function(e){e.trim()&&(n.value="",n.remove(),t(e))});var t,n},t.onclick=function(){var t=Object.assign(document.createElement("input"),{multiple:"true",type:"file"});return t.onchange=function(){return new Promise((function(n){return n(e._ChunkAndSendEachFile(t))}))},t.click()},this._messageHooks["text-message"]=function(e){console.log("[RTC]Received message->",e);var t=document.createElement("text-received");return t.data=e,document.body.appendChild(t)}}},{key:"_sendPartialFile",value:(t=y()(h.a.mark((function e(t){var n,r,i,s,a,o,c=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.bufferChunk,r=t.data,i=n.length,s=0,a=h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n[t],c._sendJSON({type:"file-chunk",data:r}),e.next=4,re(window,"chunk-ready");case 4:if(e.sent.detail.id!==r.id){e.next=10;break}return c._sendRaw(a),e.next=10,re(window,"chunk-ready").then((function(){if(s+=a.byteLength,c.__reportProgress(!0,s,r.size),t===i-1){var e=document.querySelector("file-progress");return e&&(e.onclick=function(){return e.remove()}),c._sendJSON({type:"complete"})}return 1}));case 10:case"end":return e.stop()}}),e)})),o=0;case 5:if(!(o<n.length)){e.next=10;break}return e.delegateYield(a(o),"t0",7);case 7:o++,e.next=5;break;case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"_ChunkAndSendEachFile",value:(e=y()(h.a.mark((function e(t){var n,r,i,s,a,o,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.files,r=!0,i=!1,s=void 0,e.prev=4,a=n[Symbol.iterator]();case 6:if(r=(o=a.next()).done){e.next=14;break}return c=o.value,Ae.chunk(c,this._sendPartialFile),e.next=11,re(window,"file-sent");case 11:r=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),i=!0,s=e.t0;case 20:e.prev=20,e.prev=21,r||null==a.return||a.return();case 23:if(e.prev=23,!i){e.next=26;break}throw s;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),e,this,[[4,16,20,28],[21,,23,27]])}))),function(t){return e.apply(this,arguments)})},{key:"_dcOnMessage",value:function(e){var t=this,n=e.data,r="string"==typeof n?JSON.parse(n):n;if(!C(r))return Ie.merge({file:r,data:this._fileMeta},(function(e){return t.__reportProgress(!1,e,t._fileMeta.size)}),We.bind(this)),console.log("received chunk"),this._sendJSON({type:"chunk-ready"});var i=r||{},s=i.type,a=i.data;if(s){var o=this._messageHooks[s];if(o)return o(a)}}},{key:"_onUnmount",value:function(){this._socket.close(),this._closeRTCConn()}},{key:"_startConn",value:function(){this._socket.send({type:"init",data:{sess_id:this._sess_id}}),this._socket.onmessage=this._wsOnMessage}},{key:"__updateReport__",value:function(e){return this._reportHook.textContent=e}},{key:"_socketError",value:function(e){return this._content.getRouter().pushStatus(500,e||"Could not Connect to the server")}}]),i}();function We(e){this._progressElement&&this._progressElement.remove();var t=new qe(URL.createObjectURL(new Blob([e],{type:this._fileMeta.type})),this._fileMeta);document.body.append(t),this._fileMeta=null}var Ve={route:"/session",element:"div",idx:"$session",children:[{element:"div",attrs:{id:"reporthooks"}},{element:"button",attrs:{ripple:"",id:"file-send",class:"actionbtn",textContent:"send file",style:"display:none;margin:auto;margin-top:20px"}},{element:"button",attrs:{ripple:"",id:"message-send",class:"actionbtn",textContent:"Send Message",style:"display:none;margin:auto;margin-top:20px"}},{element:"button",attrs:{ripple:"",class:"actionbtn",style:"position:absolute;bottom:10px;padding:6px;left:5px; text-transform: unset;"},events:{click:function(){var e=document.getElementById("logger-area");return"block"!==e.style.display?(e.style.display="block",this.attrs.textContent="hide Logs"):(e.style.display="none",this.attrs.textContent="click to see logs")}},children:["Click to see Logs"]},{element:"textarea",attrs:{readonly:!0,id:"logger-area",style:"resize:none;text-align:justify;display:none;overflow:scroll;height:20%;width:55%;position:absolute;background:#fff;bottom:80px;left:5px"}},{element:"div",attrs:{id:"file-area"}}],onrender:function(e){if(!this.attrs.hasConn)return function(e,t){return Ge.apply(this,arguments)}(e,this)},onUnmount:function(){O.emit("unmount-route")}};function Ge(){return(Ge=y()(h.a.mark((function e(t,n){var r,i,s,a,o,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.qs,i=ae(r)){e.next=4;break}return e.abrupt("return",n.getRouter().pushStatus(500,"Invalid data provided"));case 4:return console.log(i),s=i.id,a=i.device_id,e.next=8,oe.post("/api/verify/",!0,JSON.stringify({sess_id:s}),{"content-type":"application/json"});case 8:return o=e.sent,e.next=11,o.json();case 11:if(!(c=e.sent).success){e.next=16;break}return e.abrupt("return",new Ue(s,a,n));case 16:if(!c.error){e.next=18;break}return e.abrupt("return",n.getRouter().pushStatus(500,"No session exists."));case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}z("https://fonts.googleapis.com/css?family=Open+Sans"),I.registerRoute(we),I.registerRoute(Ve),ce(I,!1).then((function(){return I.startLoad()}))}});