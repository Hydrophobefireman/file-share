!function(e){function t(t){for(var r,a,o=t[0],c=t[1],u=t[2],d=0,h=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&h.push(s[a][0]),s[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);h.length;)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},s={0:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;i.push([21,1]),n()}({12:function(e,t,n){e.exports=function(){return new Worker(n.p+"0e3f08016a646afb6f67.worker.js")}},13:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);n(13);var r,s=n(5),i=n.n(s),a=n(4),o=n.n(a),c=n(6),u=n.n(c),l=n(7),d=n.n(l),h=n(0),p=n.n(h),f=n(8),v=n.n(f),y=n(1),m=n.n(y),g=n(2),_=n.n(g),k=n(3),x=n.n(k),b=n(9),w=n.n(b),C=function(e){return e.constructor===Object},S=function(e){if("string"==typeof e)return"/"===e[0]?location.hash=e:location.hash="/".concat(e)},O=new(function(){function e(){_()(this,e),this.EventCache={}}return x()(e,[{key:"emit",value:function(e,t){return window.dispatchEvent(new CustomEvent(e,{detail:t}))}},{key:"listen",value:function(e,t){return this.EventCache[e]=t,window.addEventListener(e,t)}},{key:"detroyEvt",value:function(e,t){window.removeEventListener(e,t)}},{key:"destroyAll",value:function(){for(var e=0,t=Object.keys(this.EventCache);e<t.length;e++){var n=t[e];this.detroyEvt(n,this.EventCache[n])}}}]),e}()),R=function(){},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return v()(Array(e)).join(".").replace(/[.]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},E=((r=document.createElement("style")).innerHTML="",document.head.appendChild(r),r.sheet),M=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E,n=Array.from(t.rules);return n.filter((function(t){return t.selectorText===e}))[0]},j=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E,r=Object.keys(t),s=0,i=r;s<i.length;s++){var a=i[s];if(!["$$element","$$parent"].includes(a)){var o=t[a];if("class"===a)e.className="string"==typeof o?o:v()(o).join(" ");else if("events"===a)for(var c=0,u=Object.keys(o);c<u.length;c++){var l=u[c],d=o[l];e.addEventListener(l,d)}else if("style"===a){var h=void 0,p=void 0,f=void 0;if(h=C(o)?P(o):o,f=e.getAttribute("_routercontent")||t._routercontent){var y=M('[_routercontent="'.concat(f,'"]'));y?y.style=h:p=!0}else f=T(),p=!0;p&&(e.setAttribute("_routercontent",f),n.insertRule("[_routercontent='".concat(f,"']{").concat(h,"}")))}else["___innerHTML___","innerText","textContent"].includes(a)?"___innerHTML___"===a?e.innerHTML=o:e.textContent=o:e.setAttribute(a,o)}}},D={q:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?document.querySelector(e):Array.from(document.querySelectorAll(e))},id:function(e){return document.getElementById(e)},className:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Array.from(document.getElementsByClassName(e));return t?n[0]:n},create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E,r=document.createElement(e);return t&&"object"==w()(t)&&j(r,t,n),r},get:function(e,t){return e.getAttribute(t)},set:function(e,t,n){return e.setAttribute(t,n)},empty:function(e){var t;for(t=e.lastChild;t;)e.removeChild(t),t=e.lastChild}},L=function(e){return e instanceof Function},H=function(e){return"AsyncFunction"===e.constructor.name},P=function(e){if("string"==typeof e)return e;for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];t.push("".concat(s,":").concat(e[s]))}return t.join(";")};var $=function(e){var t=0|e/1048576;if(t)return"".concat(t," MB");var n=0|e/1024;return n?"".concat(n," KB"):"".concat(e," b")},N=function(e,t){if(e){var n=e.routeCache();return n?n[t]:null}return null};function q(e,t){if(!window.customElements.get(e))return window.customElements.define(e,t)}D.q("noscript").remove();var B={element:"a",attrs:{href:"/#/",style:{display:"block",color:"#000"}},events:{click:function(e){e.preventDefault(),location.hash="/"}},textContent:"Click Here to Go Back",children:[]},A={display:"block","text-align":"center","font-family":"sans-serif",padding:"8px",margin:"auto","font-weight":"bold"},I=new(function(){var e,t,n,r;function s(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.$ROOT||D.id("app-root")||D.q("body");_()(this,s),this._setVars(t),window.onhashchange=function(t){return e.navData=t,e.routeChange(),e._runDirectives()},this._runDirectives()}return x()(s,[{key:"parseHash",value:function(e){return function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location;if("#"===t[0])e=t.substr(1);else try{e=new URL(t).hash.substr(1)}catch(t){e="/",console.log(t)}var n=e.split("?"),r=[0===e.length?"/":n[0],n[1]],s=r[0],i=r[1];return{path:s,qs:i}}(e)}},{key:"__runConditionals",value:(n=m()(p.a.mark((function e(){var t,n,r,s,i,a,o,c,u,l,d,h;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=v()(document.querySelectorAll("[_routerif]")),n=!0,r=!1,s=void 0,e.prev=4,i=t[Symbol.iterator]();case 6:if(n=(a=i.next()).done){e.next=27;break}if(o=a.value,c=D.get(o,"_routerif"),u=D.get(o,"_routerthen"),!new Function("$","return ".concat(c)).call(this,o)){e.next=17;break}(l=o.$)&&o.replaceWith(l),u&&new Function("$",u).call(this,l||o),e.next=24;break;case 17:if(!(o.$ instanceof HTMLElement)){e.next=19;break}return e.abrupt("continue",24);case 19:d={_routerif:c},u&&(d._routerthen=u),(h=D.create("router-data",d)).$=o,o.replaceWith(h);case 24:n=!0,e.next=6;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(4),r=!0,s=e.t0;case 33:e.prev=33,e.prev=34,n||null==i.return||i.return();case 36:if(e.prev=36,!r){e.next=39;break}throw s;case 39:return e.finish(36);case 40:return e.finish(33);case 41:case"end":return e.stop()}}),e,this,[[4,29,33,41],[34,,36,40]])}))),function(){return n.apply(this,arguments)})},{key:"__runEventListeners",value:(t=m()(p.a.mark((function e(){var t,n,r,s,i,a,o,c=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=D.q("[_routerEvt][_routerAct]",!1),n=!0,r=!1,s=void 0,e.prev=4,i=function(){var e=o.value,t=D.get(e,"_routerEvt"),n=D.get(e,"_routerAct");e[t]=function(){new Function(n).call(c)}},a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)i();e.next=13;break;case 9:e.prev=9,e.t0=e.catch(4),r=!0,s=e.t0;case 13:e.prev=13,e.prev=14,n||null==a.return||a.return();case 16:if(e.prev=16,!r){e.next=19;break}throw s;case 19:return e.finish(16);case 20:return e.finish(13);case 21:case"end":return e.stop()}}),e,null,[[4,9,13,21],[14,,16,20]])}))),function(){return t.apply(this,arguments)})},{key:"_runDirectives",value:(e=m()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.__runConditionals();case 2:this.__runEventListeners();case 3:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"_callFuncWithThis",value:function(e,t,n,r){if(H(e))return e.apply(t,[r]).then((function(e){return n&&(e||{}).stopUpdate&&j(n,t.attrs),e}));var s=e.apply(t,[r]);return n&&((s||{}).stopUpdate||j(n,t.attrs)),s}},{key:"_setVars",value:function(e){var t=this;this.stopSubsequentRenders=!1,this.root=e,this.routeMap={},this.routes=[],this.routeCache={},this.unMountFn=function(){},this.unmountRoute=function(){t.unMountFn(),t.routeCache={}},this.statusHandler={404:{element:"div",attrs:{style:A},textContent:"The Page you are requesting was not found",children:[B]},500:{element:"div",attrs:{style:A},textContent:"An Error Occured while trying to process your request",children:[B]}}}}]),x()(s,[{key:"isUserGoingBack",value:function(e){var t=this.navData||{};return!("".concat(location.protocol,"//").concat(location.host,"/#").concat(e)!=t.oldURL||(console.log("Same url navigation"),0))}},{key:"routeParser",value:function(e){return this.parseHash(e).path}},{key:"load",value:function(e){return S(e)}},{key:"lazyload",value:function(e,t,n){var r=this;n?this.registerRoute(n):this.registerRoute({route:e,element:"div",textContent:"loading",attrs:{style:{margin:"100px"}}});var s=this.getRouteName(this.currentRoute)===e;return s&&this.startLoad(),t.then((function(e){if(r.registerRoute(e.default),s)return r.startLoad()}))}},{key:"startLoad",value:function(){this.routeChange()}},{key:"pushStatus",value:function(e,t){var n=this.statusHandler[e];return n.textContent=t||n.textContent,n?this.render(n,this.root,!0):this.render(this.statusHandler[404])}},{key:"getRouteName",value:function(e){var t=e.split("/").filter((function(e){return e}))[0];return t?"/".concat(t,"/"):"/"}},{key:"isValidRoute",value:function(e){if(this.routes.includes(e))return{res:!0,args:null,_fRoute:e};try{var t=e.split("/").filter((function(e){return e})),n="/".concat(t[0],"/");return this.routes.includes(n)?{res:!0,args:t.slice(1),_fRoute:n}:{res:!1}}catch(t){return console.log(t),{res:!1}}}},{key:"routeChange",value:function(){var e=this.parseHash(location.href),t=this.isValidRoute(e.path),n=t.res,r=t.args,s=t._fRoute;n?(console.log("rendering"),this.render(this.routeMap[s],this.root,!0,{args:r,qs:e.qs})):this.render(this.statusHandler[404],this.root,!0,r)}},{key:"__toSets",value:function(e){"string"==typeof e.attrs.class?e.attrs.class=new Set([e.attrs.class]):Array.isArray(e.attrs.class)&&(e.attrs.class=new Set(e.attrs.class))}},{key:"__objDef",value:function(e,t,n,r,s){var i=this,a=function(){return e.$$element};e.attrs=e.attrs||{},this.__toSets(e),e.getRouter=function(){return i},e.update=function(){if(a()&&e.attrs)return j(a(),e.attrs)},e.remove=function(){if(a().parentNode)return a().replaceWith(function(){var t=D.create("router-data");return e._$routerData=t,t}())},e.add=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";e._$routerData&&(e._$routerData.replaceWith(a()),e._$routerData=void 0),t&&(a().style.display=t)},e.routeCache=function(){return i.routeCache},e.reRender=m()(p.a.mark((function o(){var c,u=arguments;return p.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=u.length>0&&void 0!==u[0]?u[0]:e,e.attrs._routercontent=a().getAttribute("_routercontent"),o.t0=a(),o.next=5,i.render(c,t,n,r,s);case 5:return o.t1=o.sent,o.abrupt("return",o.t0.replaceWith.call(o.t0,o.t1));case 7:case"end":return o.stop()}}),o)}))),e.safeRerender=function(t){e.add(),e.reRender(t),e.add()}}},{key:"render",value:(r=m()(p.a.mark((function e(t,n){var r,s,i,a,o,c,u,l,d,h,f,v,y,m,g,_,k,x,b,w,C,S,O,R,T,E,M,j=this,P=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=P.length>2&&void 0!==P[2]&&P[2],s=P.length>3?P[3]:void 0,i=P.length>4?P[4]:void 0,!this.stopSubsequentRenders&&t){e.next=6;break}return console.log("preventing render"),e.abrupt("return");case 6:if("string"!=typeof t){e.next=9;break}return a=document.createTextNode(t),e.abrupt("return",(n.appendChild(a),a));case 9:if(o=s||{},this._runDirectives(),c=t.element,u=t.attrs,l=t.beforeRender,d=t.onrender,h=t.textContent,f=t._innerHTML,v=t.onUnmount,y=t.events,m=t.children,g=t.isRoute,this.__objDef(t,n,r,o,i),(g||r)&&this.unmountRoute(),!L(l)){e.next=24;break}if(!H(l)){e.next=21;break}return e.next=18,this._callFuncWithThis(l,t,null,o);case 18:_=e.sent,e.next=22;break;case 21:_=this._callFuncWithThis(l,t,null,o);case 22:if(!_||!_.stopExec){e.next=24;break}return e.abrupt("return");case 24:for(k=D.create(c,u),x={},t.idx&&(x[t.idx]=t),Object.assign(this.routeCache,z(m),x),t.$$element=k,t.$$parent=i||null,h||0===h?k.textContent=h:f&&(console.warn("innerHTML can be dangerous!"),k.innerHTML=f),b=function(){var e=C[w];k.addEventListener(e,(function(n){return j._callFuncWithThis(y[e],t,k,n)}))},w=0,C=Object.keys(y||{});w<C.length;w++)b();for(S=!0,O=!1,R=void 0,e.prev=36,T=(m||[])[Symbol.iterator]();!(S=(E=T.next()).done);S=!0)M=E.value,this.render(M,k,!1,null,t);e.next=44;break;case 40:e.prev=40,e.t0=e.catch(36),O=!0,R=e.t0;case 44:e.prev=44,e.prev=45,S||null==T.return||T.return();case 47:if(e.prev=47,!O){e.next=50;break}throw R;case 50:return e.finish(47);case 51:return e.finish(44);case 52:if(r&&D.empty(n),n.appendChild(k),g&&(this.unMountFn=v||function(){}),!L(d)){e.next=62;break}if(!H(d)){e.next=61;break}return e.next=59,this._callFuncWithThis(d,t,k,o);case 59:e.next=62;break;case 61:this._callFuncWithThis(d,t,k,o);case 62:return e.abrupt("return",k);case 63:case"end":return e.stop()}}),e,this,[[36,40,44,52],[45,,47,51]])}))),function(e,t){return r.apply(this,arguments)})},{key:"registerRoute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(e.route&&e.element&&"/"===e.route[0]||t))throw new Error("invalid values");if(!t){this.routes.includes(e.route)||this.routes.push(e.route);var n=e.element,r=e.children,s=e.selector,i=e.attrs,a=e.beforeRender,o=e.events,c=e.hasRouteArgs,u=e.onUnmount,l=e.onrender,d=e.route,h=e.textContent,p=e._innerHTML,f=e.idx;return this.routeMap[d]={idx:f,element:n,selector:s,beforeRender:a,onrender:l,hasRouteArgs:c,attrs:i,textContent:h,_innerHTML:p,events:o,children:r,onUnmount:u,isRoute:!0}}var v=e.status;this.statusHandler[v]=e}},{key:"currentQS",get:function(){return this.parseHash(location.hash).qs}},{key:"currentRoute",get:function(){return this.routeParser(location.href)}}]),s}());function z(e){if(!e)return{};var t={},n=!0,r=!1,s=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var o=i.value;o.idx&&(t[o.idx]=o)}}catch(e){r=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return t}q("router-data",function(e){function t(){var e;return _()(this,t),(e=i()(this,o()(t).call(this))).attachShadow({mode:"open"}).appendChild(Object.assign(document.createElement("style"),{innerHTML:":host{display:none}"})),e}return u()(t,e),t}(d()(HTMLElement)));var F=function(){var e=m()(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",((n=document.createElement("link")).href=t,n.rel="stylesheet",document.head.appendChild(n)));case 4:e.prev=4,e.t0=e.catch(0),console.log("Could not append stylesheet",e.t0);case 7:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(t){return e.apply(this,arguments)}}(),J=n(10),U=n.n(J);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G,K=(G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s={};return t.blur||(s.blur=function(){(function(e,t){if(!e.attrs.value||!e.attrs.value.trim()){var n=N(e,t);n.attrs.class.delete("moveup"),n.attrs.class.add("movedown"),n.update(),setTimeout((function(){return n.attrs.class.delete("movedown"),n.update()}),110)}})(this,r),this.update()}),t.focus||(s.focus=function(){this.attrs.untouched=!1,function(e,t){var n=N(e,t);n.attrs.class.add("moveup"),n.attrs.class.delete("movedown"),n.update()}(this,r)},!t.keydown&&(s.keydown=function(e){85===e.keyCode&&e.ctrlKey&&(e.preventDefault(),this.$$element.value=this.$$element.value.slice(this.$$element.selectionStart,this.$$element.value.length),this.$$element.setSelectionRange(0,0))}),!t.keyup&&(s.keyup=function(){return this.attrs.value=this.$$element.value})),{idx:e,element:"input",attrs:{type:n?"password":"text",spellcheck:!1,class:"paper-input"},onrender:function(){this.attrs.value?this.$$element.focus():(this.attrs.untouched=!0,this.attrs.clean=!0)},events:V({},t,{},s)}},function(e,t,n,r){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return{element:"div",children:[{idx:e,onrender:function(){var e=N(this,n);e&&e.$$element&&e.$$element.value.trim()&&(this.attrs.class=new Set(["_animate","moveup"]))},element:"div",textContent:t,attrs:{class:"_animate"}},G(n,r,s,e)]}}),Y=function(e){function t(e,n,r,s){var a;_()(this,t);var c=(a=i()(this,o()(t).call(this))).createTemplate();return a.attachShadow({mode:"open"}).appendChild(c.content.cloneNode(!0)),a.svg=function(){return a.shadowRoot.querySelector("svg")},a.circle=function(){return a.shadowRoot.querySelector("circle")},e&&(a.size=e),n&&(a.color=n),r&&(a.svg().style=r),s&&(a.circle().style=s),a}return u()(t,e),x()(t,[{key:"attributeChangedCallback",value:function(e,t,n){"size"===e?this.size=n:"color"===e?this.color=n:"svgstyle"===e?this.svgstyle=n:"circlestyle"===e&&(this.circlestyle=n)}},{key:"createTemplate",value:function(){var e=D.create("svg",{viewbox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"}),t=D.create("circle",{fill:"none","stroke-width":6,"stroke-linecap":"round",cx:33,cy:33,r:30}),n=document.createElement("template");e.appendChild(t);var r=document.createElement("style");return r.innerHTML="svg{display:inline-block;width: 65px;height: 65px;animation:rotator 1.4s linear infinite}@keyframes rotator{0%{transform:rotate(0)}100%{transform:rotate(270deg)}}circle{stroke:#6f70ee;stroke-dasharray:120;stroke-dashoffset:0;transform-origin:center;animation:dash 1.4s ease-in-out infinite}@keyframes dash{0%{stroke-dashoffset:120}50%{stroke-dasharray:200;stroke-dashoffset:190;transform:rotate(135deg)}100%{stroke-dashoffset:120;transform:rotate(450deg)}}",n.innerHTML=r.outerHTML+e.outerHTML,n}},{key:"size",set:function(e){var t=this.svg();t.style.height=t.style.width=e},get:function(){return this.svg().style.height}},{key:"color",set:function(e){this.circle().style.stroke=e},get:function(){return this.circle().style.stroke}},{key:"svgstyle",set:function(e){return this.svg().style=e}},{key:"circlestyle",set:function(e){return this.circle().style=e}}],[{key:"observedAttributes",get:function(){return["size","color","svgstyle","circlestyle"]}}]),t}(d()(HTMLElement));q("mat-spinner",Y);var Q=window.location.host.includes("localhost")?"localhost:5000":"file-share-rtc.herokuapp.com";function X(e,t){return new Promise((function(n){e.addEventListener(t,n,{once:!0})}))}var Z="".concat(window.location.protocol,"//").concat(Q),ee=function(e){try{return btoa(JSON.stringify(e))}catch(e){return console.warn(e),null}},te=function(e){try{return JSON.parse(atob(e))}catch(e){return console.warn(e),null}},ne=function(){function e(){_()(this,e)}var t,n;return x()(e,null,[{key:"get",value:(n=m()(p.a.mark((function e(t){var n,r,s,i=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],r=i.length>2&&void 0!==i[2]?i[2]:{},s=n?Z+t:t,e.next=5,fetch(s,{headers:r,credentials:"include"});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"post",value:(t=m()(p.a.mark((function e(t){var n,r,s,i,a=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],r=a.length>2?a[2]:void 0,s=a.length>3&&void 0!==a[3]?a[3]:{"content-type":"application/x-www-form-urlencoded"},i=n?Z+t:t,e.next=6,fetch(i,{method:"post",body:r,headers:s,credentials:"include"});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}();function re(e,t){return se.apply(this,arguments)}function se(){return(se=m()(p.a.mark((function e(t,n){var r,s,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){var e=m()(p.a.mark((function e(){var n,r=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(r.length>0&&void 0!==r[0])||r[0],t.stopSubsequentRenders=!1,D.empty(t.root),t.root.appendChild(new Y(null,null,P({margin:"auto",position:"fixed",top:0,bottom:0,left:0,right:0}))),t.root.appendChild((s=void 0,(s=D.create("div",{style:"margin:auto;text-align:center"})).textContent="Connecting to the server",s)),e.next=7,ne.get("/api/gen_204");case 7:setTimeout((function(){return n?t.startLoad():void 0}),450);case 8:case"end":return e.stop()}var s}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(e){return{element:"div",status:503,textContent:"An error occured while contacting the server..please reload the page and try again",attrs:{style:{margin:"auto","text-align":"center"},class:"_errComponent"},children:[{element:"button",attrs:{style:{background:"#fff",color:"#000",border:"1px solid #6f70ee","border-radius":"20px",display:"block",margin:"auto","margin-top":"20px",padding:"8px",width:"20%",outline:"none",cursor:"pointer"},class:"ripple"},textContent:"Reload",events:{click:function(){return re(e)}}}]}},i=function(e,t){return console.log(e),t.registerRoute(s(t),!0),setTimeout((function(){return t.pushStatus(503),t.stopSubsequentRenders=!0}),500)},e.abrupt("return",ie((function(){return r(n)}),2,(function(e){return i(e,t)})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=function(){var e=m()(p.a.mark((function e(t,n,r){var s,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<n)){e.next=16;break}return e.prev=2,e.next=5,t();case 5:return e.abrupt("return",e.sent);case 8:e.prev=8,e.t0=e.catch(2),s=e.t0;case 11:return e.next=13,new Promise((function(e){setTimeout((function(){return e()}),100)}));case 13:i++,e.next=1;break;case 16:r(s);case 17:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n,r){return e.apply(this,arguments)}}(),ae="".concat(navigator.platform,"-").concat(navigator.product,"-").concat(T(5)),oe={element:"div",onrender:function(){var e=N(this,"deviceID"),t=N(this,"deviceID-ph");t.attrs.class.add("moveup"),e.attrs.value=ae,e.reRender(),t.reRender()},children:["Type Your Device Name",K("deviceID-ph","Device Name","deviceID")]};function ce(e,t){var n=N(t,"notif");return n.$$element.style.transform="translate(0px,0px)",n.$$element.textContent=e,setTimeout((function(){return n.reRender()}),2e3)}function ue(e,t){return le.apply(this,arguments)}function le(){return(le=m()(p.a.mark((function e(t,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(n,"$spinner").add(),e.next=4,ne.post("/api/validate-id/",!0,JSON.stringify({sess_id:t}),{"content-type":"application/json"});case 4:return r=e.sent,e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(){return(de=m()(p.a.mark((function e(t){var n,r,s,i,a,o,c,u,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.keyCode,r=this.attrs.value||"",!(s=r.trim())||13!==n){e.next=34;break}return e.next=6,ue(s,this);case 6:if("unique"!==e.sent.type){e.next=11;break}ce("No Session exists with the given ID",this),e.next=33;break;case 11:return i=N(this,"deviceID").attrs.value,e.next=14,ne.post("/api/get-id/",!0,JSON.stringify({sess_id:s,device_id:i,default_token:ae}),{"content-type":"application/json"});case 14:return a=e.sent,e.next=17,a.json();case 17:if(o=e.sent,!((u=o.init_conn).length-1)){e.next=25;break}return e.next=22,getPreferredUser();case 22:c=e.sent,e.next=26;break;case 25:c=u[0];case 26:if("no_id"!==o.type){e.next=30;break}return e.abrupt("return",ce("An error occured while connecting..please start a new session",this));case 30:if(!(l=ee({id:s,device_id:i,preferred:c}))){e.next=33;break}return e.abrupt("return",S("/session?".concat(l)));case 33:return e.abrupt("return",N(this,"$spinner").remove());case 34:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function he(e){return pe.apply(this,arguments)}function pe(){return(pe=m()(p.a.mark((function e(t){var n,r,s,i,a,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.keyCode,r=this.attrs.value||"",!(s=r.trim())||13!==n){e.next=26;break}return e.next=6,ue(s,this);case 6:if("unique"!==e.sent.type){e.next=24;break}return i=N(this,"deviceID").attrs.value,e.next=11,ne.post("/api/set-id/",!0,JSON.stringify({sess_id:s,device_id:i,default_token:ae}),{"content-type":"application/json"});case 11:return a=e.sent,e.next=14,a.json();case 14:if("init_connection"!==e.sent.type){e.next=21;break}if(!(o=ee({id:s,device_id:i}))){e.next=19;break}return e.abrupt("return",S("/session?".concat(o)));case 19:e.next=22;break;case 21:ce("Invalid Data",this);case 22:e.next=25;break;case 24:ce("A Session already exists with that name",this);case 25:return e.abrupt("return",N(this,"$spinner").remove());case 26:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var fe={idx:"startsessbtn",element:"button",attrs:{style:{"border-radius":"5px",margin:"10px"},class:["ripple","actionbtn"]},children:["Start a Session"],events:{click:function(){var e=N(this,"joinSessBox"),t=N(this,"startSessBox");e.remove(),t.add("")}}},ve={idx:"joinsessbtn",element:"button",attrs:{style:{"border-radius":"5px",margin:"10px"},class:["ripple","actionbtn"]},children:["Join a Session"],events:{click:function(){var e=N(this,"joinSessBox"),t=N(this,"startSessBox");e.add(""),t.remove()}}},ye={idx:"joinSessBox",onrender:function(){this.remove()},element:"div",children:[{element:"div",children:["Type a session name to join"]},K("joinID-ph","Session ID","joinID",{keydown:function(e){return de.apply(this,arguments)}})]};console.log(K("startID-ph","Session ID","startID",{keydown:he}));var me,ge={route:"/",element:"div",attrs:{},children:[{element:"div",idx:"notif",attrs:{notification:""}},oe,fe,ve,ye,{onrender:function(){this.remove()},children:[{element:"div",children:["Type a session name to start. Others will find your device with this name"]},K("startID-ph","Session ID","startID",{keydown:he})],idx:"startSessBox",element:"div"},{element:"mat-spinner",idx:"$spinner",onrender:function(){this.remove()},attrs:{svgstyle:"margin:auto;display:block"}}]},_e=function(){function e(){_()(this,e)}return x()(e,[{key:"__defaultOnMessage",value:function(e){if(!["ping","pong"].includes(e.data)){var t=JSON.parse(e.data);this._socketID=t.socket_id}}},{key:"startConn",value:function(e){var t=this;return new Promise((function(n,r){t.socket=new WebSocket(function(e){return"".concat("https:"===window.location.protocol?"wss://":"ws://").concat(Q,"/").concat(e)}(e)),t.socket.onopen=function(){t.socket.onmessage=t.__defaultOnMessage,t._pingPongs(),n(t.socket)},t.socket.onerror=function(e){return r(e)}}))}},{key:"close",value:function(){try{this.socket.close()}catch(e){console.warn(e)}}},{key:"send",value:function(e){return this.socket.send(JSON.stringify(e))}},{key:"sendString",value:function(e){return this.socket.send(e)}},{key:"_pingPongs",value:function(){var e=this;this.pingtimer=setTimeout((function(){e.socket.readyState===e.socket.OPEN?(e.send({type:"ping"}),e._pingPongs()):clearTimeout(e.pingtimer)}),2e4)}},{key:"onmessage",set:function(e){this.socket.onmessage=function(t){var n=JSON.parse(t.data||"{}");return"ping"===n.type||"pong"===n.type?void 0:e(n)}}},{key:"readyState",get:function(){return this.socket.readyState}},{key:"isUsable",get:function(){return!this.socket||[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)}}]),e}(),ke=function(){return(me||{}).isUsable?me:me=new _e},xe="div[full]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.61);z-index:10;padding:16px}div[header],input{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}div[header]{font-weight:700;user-select:none}div[message],div[area]{-webkit-box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);z-index:3;background:#fff;border-radius:8px;width:100%;padding:16px;max-width:500px}input,span{display:inline-block}input{user-select:none;background-color:#f5f5f5;padding:12px;margin-top:20px;margin-bottom:20px;width:95%;border:none;outline:0;border-radius:50px}span:hover{background-color:#d2d2d2}span{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:60px;text-align:center;padding:6px;cursor:pointer;border-radius:8px;color:var(--primary-color)}";var be=n(12);function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(n,!0).forEach((function(t){U()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se,Oe=new(n.n(be).a),Re=(Se={_handlers:{},worker:null},new(function(){function e(t){_()(this,e),Se.worker=t,this.onmessage=this.onmessage.bind(this),Se.worker.onmessage=this.onmessage}return x()(e,[{key:"setHandler",value:function(e,t){Se._handlers[e]=t}},{key:"onmessage",value:function(e){var t=e.data,n=t.type,r=t.data,s=Se._handlers[n];if(s)return s(r);console.log("Worker Said:",r)}},{key:"handlers",get:function(){return Se._handlers}}]),e}())(Oe)),Te=function(){var e=m()(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Response(t).arrayBuffer();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){var e;function t(){_()(this,t),this.chunkBuffer=this.chunkBuffer.bind(this),this._buffer=[]}return x()(t,[{key:"chunkBuffer",value:function(e){this._buffer.push(e.fileChunk),e.over&&(this._fn({bufferChunk:this._buffer,data:this._meta}),O.emit("file-sent"))}},{key:"chunk",value:(e=m()(p.a.mark((function e(t,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._buffer=[],this._fn=n,e.next=4,Te(t);case 4:r=e.sent,this._meta={type:t.type,name:t.name,size:t.size,id:T(15)},Oe.postMessage({data:Ce({file:r},this._meta),type:"file-chunk"},[r]),Re.setHandler("chunked-file",this.chunkBuffer);case 8:case"end":return e.stop()}}),e,this)}))),function(t,n){return e.apply(this,arguments)})}]),t}(),Me=function(){var e;function t(){var e=this;_()(this,t),this.mergeBuffer=this.mergeBuffer.bind(this),this._buffer=[],this._currentBufferByteSize=0,Re.setHandler("merged-file",this.mergeBuffer),Re.setHandler("merge-progress",(function(t){var n=t.done;return e._currentBufferByteSize=n}))}return x()(t,[{key:"mergeBuffer",value:function(e){var t=this;console.log("final File:"),Promise.resolve(this._onFullFile(e)).then((function(){return t._buffer=[],t._currentBufferByteSize=0}))}},{key:"merge",value:(e=m()(p.a.mark((function e(t,n,r){var s,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=t.file,i=t.data,this._onFullFile=r,this._meta=i,Promise.resolve(this._currentBufferByteSize).then(n||R),Oe.postMessage({data:s,type:"file-merge"},[s]);case 5:case"end":return e.stop()}}),e,this)}))),function(t,n,r){return e.apply(this,arguments)})},{key:"complete",value:function(){Oe.postMessage({type:"complete",data:this._meta})}}]),t}(),je="<style>div[area],span{border-radius:8px}div[full]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.61);z-index:10;padding:16px}div[area]{-webkit-box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);z-index:3;background:#fff;width:100%;padding:16px;max-width:500px}div[header]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;font-weight:700;user-select:none}div[progress]{margin:auto;transition:0.2s;height:20px;background-color:var(--primary-color);border-radius:20px;}span{display:inline-block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:60px;text-align:center;padding:6px;cursor:pointer;color:var(--primary-color)}a{color:unset;text-decoration:none;}</style>",De=function(e){function t(e,n,r){var s;_()(this,t),(s=i()(this,o()(t).call(this)))._done=e||0,s._total=n||100,s._str=r||"";var a="".concat(je,"<div full><div area><div header></div><div progress></div><div><span progress-text></span></div></div></div>"),c=document.createElement("template");c.innerHTML=a;var u=s.attachShadow({mode:"open"});return u.appendChild(c.content.cloneNode(!0)),s._header=u.querySelector("div[header]"),s._progressDiv=u.querySelector("div[progress]"),s._progressText=u.querySelector("span[progress-text]"),s}return u()(t,e),x()(t,[{key:"connectedCallback",value:function(){this._render()}},{key:"_render",value:function(){this._header.textContent=this._str;var e=(this._done/this._total*100).toFixed(2),t="".concat(Math.min(e,100),"%");this._progressDiv.style.width=t,this._progressText.textContent="".concat(t," ").concat($(this._done)," of ").concat($(this._total))}},{key:"setValues",value:function(e,t,n){this._total=t,this._done=e,this._str=n,this._render()}}]),t}(d()(HTMLElement)),Le=De,He=function(e){function t(e,n){var r;_()(this,t),r=i()(this,o()(t).call(this));var s="".concat(je,"<div full><div area><div header></div><div download></div><div size></div><span cancel>Cancel</span><span download><a>Download</a></span></div></div>");r._url=e;var a=document.createElement("template");a.innerHTML=s;var c=r.attachShadow({mode:"open"});return c.appendChild(a.content.cloneNode(!0)),r._header=c.querySelector("div[header]"),r._download=c.querySelector("div[download]"),r.__size=c.querySelector("div[size]"),r.dlButton=c.querySelector("a"),r.cancelBTN=c.querySelector("span[cancel]"),c.querySelector("div[area]").onclick=function(e){return e.stopPropagation()},r._meta=n||{},r}return u()(t,e),x()(t,[{key:"connectedCallback",value:function(){var e=this;this._header.textContent="Download Ready",this._download.textContent="Filename:".concat(this._meta.name),this.__size.textContent="Size:".concat($(this._meta.size)),this.cancelBTN.onclick=function(){return e.remove()},this.dlButton.href=this._url,this.dlButton.download=this._meta.name}}]),t}(d()(HTMLElement));var Pe=new Ee,$e=new Me;function Ne(){try{for(var e=document.getElementById("logger-area"),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var s=0,i=n;s<i.length;s++){var a=i[s];e.appendChild(document.createTextNode(C(a)?JSON.stringify(a):a))}return e.innerHTML+="&#13;&#10;",console.log.apply(this,n)}catch(e){}}q("file-download",He),q("file-progress",De),q("text-input",function(){var e={onsend:null,innerHTML:"<style>".concat(xe,'</style><div full><div area><div header>Send a Message</div><input spellcheck="false" placeholder="Send a Message" type="text"><span send-button>Send</span><span cancel-button>Cancel</span></div></div>')};return function(t){function n(){var t;_()(this,n),t=i()(this,o()(n).call(this));var r=document.createElement("template");r.innerHTML=e.innerHTML;var s=t.attachShadow({mode:"open"});return s.appendChild(r.content.cloneNode(!0)),s.querySelector("div[area]").onclick=function(e){return e.stopPropagation()},s.querySelector("div[full]").onclick=function(){return t.remove()},e.input=s.querySelector("input"),t.focus=function(){return e.input.focus()},e.input.addEventListener("keydown",(function(e){13===e.keyCode&&t.onsend&&t.onsend(t.value)})),s.querySelector("span[cancel-button]").onclick=function(){return t.remove()},t}return u()(n,t),x()(n,[{key:"value",get:function(){return e.input.value},set:function(t){return e.input.value=t}},{key:"onsend",set:function(t){var n=this;e.onsend=t,this.shadowRoot.querySelector("span[send-button]").addEventListener("click",(function(){return t(n.value)}))},get:function(){return e.onsend}}]),n}(d()(HTMLElement))}()),q("text-received",function(){var e={innerHTML:"<style>".concat(xe,"</style><div full><div message><div header>Received Message</div><input message-content readonly><span>Okay</span></div>")};return function(t){function n(t){var r;_()(this,n),r=i()(this,o()(n).call(this));var s=document.createElement("template");s.innerHTML=e.innerHTML;var a=r.attachShadow({mode:"open"});return a.appendChild(s.content.cloneNode(!0)),e.message=a.querySelector("input[message-content]"),e.message.value=t||"",a.querySelector("div[message]").onclick=function(e){return e.stopPropagation()},a.querySelector("span").onclick=a.querySelector("div[full]").onclick=function(){return r.remove()},r}return u()(n,t),x()(n,[{key:"data",set:function(t){e.message.value=t||this.data||""},get:function(){return e.message.value}}]),n}(d()(HTMLElement))}());var qe={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]};function Be(e,t){var n=D.create("div",{notification:"",textContent:e});return document.body.appendChild(n),setTimeout((function(){return n.style.transform="translate(0px,0px)",setTimeout((function(){return n.remove()}),t||2e3)}),300)}var Ae=function(){var e,t,n,r;function s(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ke();_()(this,s),O.listen("unmount-route",this._onUnmount),this._sess_id=e,this._peer=t,this._content=n,this._socket=r,this._isOfferer=void 0,this._reportHook=document.getElementById("reporthooks"),this.__reportProgress=this.__reportProgress.bind(this),this._dcOnMessage=this._dcOnMessage.bind(this),this._ondatachannel=this._ondatachannel.bind(this),this._wsOnMessage=this._wsOnMessage.bind(this),this._onUnmount=this._onUnmount.bind(this),this._sendJSON=this._sendJSON.bind(this),this._startConn=this._startConn.bind(this),this._socketError=this._socketError.bind(this),this._sendPartialFile=this._sendPartialFile.bind(this),this._socket.startConn("socket-conn/").then(this._startConn).catch(),this._messageHooks={"chunk-ready":function(e){return O.emit("chunk-ready",e)}}}return x()(s,[{key:"_closeRTCConn",value:function(){try{return this._pc.close()}catch(e){}this._pc=this._dc=null}},{key:"_onIceCandidate",value:function(e){if(e&&this._pc)return this._socket.send({type:"rtc_data",data:{icecandidate:e,sess_id:this._sess_id}})}},{key:"_iceStateChange",value:(r=m()(p.a.mark((function e(){var t,n,r,s,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._pc.iceConnectionState,["closed","disconnected","failed"].includes(t)&&(Ne("Connection is Dead.."),(n=document.querySelector("file-progress"))&&n.remove(),(r=document.querySelector("file-download"))&&r.remove(),s=document.getElementById("file-send"),i=document.getElementById("message-send"),s&&(i.style.display="none",s.style.display="none"),this.__updateReport__("Connection is dead"),Be("connection lost.retrying"),this._pc=this._isOfferer=null);case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"_wsOnMessage",value:(n=m()(p.a.mark((function e(t){var n,r,s,i,a,o,c,u=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ne("[WS]",t),n=t.type,r=t.data,s=void 0===r?{}:r,"conn_data"!==n){e.next=29;break}if(this._pc&&(Ne("[DEBUG]Removing previous connection"),this.__updateReport__("removing previous connection")),this._closeRTCConn(),this._pc=this._dc=this._isOfferer=null,!s.peer||!s.peer_device||this._pc){e.next=27;break}if(this._pc=new RTCPeerConnection(qe),this._pc.onicecandidate=function(e){var t=e.candidate;return Ne("[RTC]Ice Candidate"),u.__updateReport__("received ice candidate"),u._onIceCandidate(t)},this._pc.oniceconnectionstatechange=function(e){return u._iceStateChange(e)},this._isOfferer=s.is_offerer,!this._isOfferer){e.next=24;break}return Ne("[RTC]creating offer"),this.__updateReport__("creating offer"),this._dc=this._pc.createDataChannel(T()),this._dc.onmessage=function(e){if("init"===e.data)return Ne("[RTC]Data Channel Ready",u._dc),u.__updateReport__("data channel ready!"),u._startMainSess()},e.next=18,this._pc.createOffer();case 18:return i=e.sent,e.next=21,this._pc.setLocalDescription(i);case 21:return e.abrupt("return",this._socket.send({type:"rtc_data",data:{rtc:"offer",js:i,sess_id:this._sess_id}}));case 24:return Ne("[RTC]awaiting offer"),this.__updateReport__("Waiting offer"),e.abrupt("return",this._pc.ondatachannel=function(e){var t=e.channel;return u._ondatachannel(t)});case 27:e.next=65;break;case 29:if("rtc_data"!==n){e.next=65;break}if(a=s.rtc,o=s.js,!(c=s.icecandidate)||!this._pc){e.next=44;break}return e.prev=32,Ne("[RTC]Recieved Candidate"),this.__updateReport__("received candidate"),e.next=37,this._pc.addIceCandidate(c);case 37:return e.abrupt("return",e.sent);case 40:e.prev=40,e.t0=e.catch(32),Ne("[RTC]Could not add ice candidate"),this.__updateReport__("could not add ice candidate");case 44:if("offer"!==a||this._isOfferer){e.next=60;break}return Ne("[RTC]Recieved offer"),this.__updateReport__("recieved offer"),e.next=49,this._pc.setRemoteDescription(o);case 49:return Ne("[RTC]Creating Answer"),this.__updateReport__("creating answer"),e.t1=this._pc,e.next=54,this._pc.createAnswer();case 54:return e.t2=e.sent,e.next=57,e.t1.setLocalDescription.call(e.t1,e.t2);case 57:return e.abrupt("return",this._socket.send({type:"rtc_data",data:{rtc:"answer",js:this._pc.localDescription,sess_id:this._sess_id}}));case 60:if("answer"!==a){e.next=65;break}return Ne("[RTC]Received Answer"),this.__updateReport__("Received answer"),e.next=65,this._pc.setRemoteDescription(o);case 65:case"end":return e.stop()}}),e,this,[[32,40]])}))),function(e){return n.apply(this,arguments)})},{key:"_ondatachannel",value:function(e){return this._dc=e,this._sendRaw("init"),Ne("[RTC] Recieved Data Channel",e),this.__updateReport__("data channel ready!"),this._startMainSess()}},{key:"_sendRaw",value:function(e){if(this._dc)return this._dc.send(e)}},{key:"_sendJSON",value:function(e){return this._sendRaw(JSON.stringify(e))}},{key:"__reportProgress",value:function(e,t,n){var r="".concat(e?"sending":"receiving"," File");this._progressElement=this._progressElement||new Le(0,0,r),this._progressElement.isConnected||this._content.$$element.appendChild(this._progressElement),this._progressElement.setValues(t,n,r)}},{key:"_startMainSess",value:function(){var e=this;this._reportHook.textContent="Connected to ".concat(this._peer),this._dc.onmessage=this._dcOnMessage,this._messageHooks["file-chunk"]=function(t){e._fileMeta=t,console.log("ready for next chunk"),e._sendJSON({type:"chunk-ready",data:t})},this._messageHooks.complete=$e.complete.bind($e);var t=document.getElementById("file-send"),n=document.getElementById("message-send");t.style.display="block",n.style.display="block",n.onclick=function(){return t=function(t){return e._sendJSON({type:"text-message",data:t})},n=D.create("text-input"),document.body.appendChild(n),n.focus(),void(n.onsend=function(e){e.trim()&&(n.value="",n.remove(),t(e))});var t,n},t.onclick=function(){var t=Object.assign(document.createElement("input"),{multiple:"true",type:"file"});return t.onchange=function(){return new Promise((function(n){return n(e._ChunkAndSendEachFile(t))}))},t.click()},this._messageHooks["text-message"]=function(e){console.log("[RTC]Received message->",e);var t=document.createElement("text-received");return t.data=e,document.body.appendChild(t)}}},{key:"_sendPartialFile",value:(t=m()(p.a.mark((function e(t){var n,r,s,i,a,o,c=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.bufferChunk,r=t.data,s=n.length,i=0,a=p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n[t],c._sendJSON({type:"file-chunk",data:r}),e.next=4,X(window,"chunk-ready");case 4:if(e.sent.detail.id!==r.id){e.next=10;break}return c._sendRaw(a),e.next=10,X(window,"chunk-ready").then((function(){if(i+=a.byteLength,c.__reportProgress(!0,i,r.size),t===s-1){var e=document.querySelector("file-progress");return e&&(e.onclick=function(){return e.remove()}),c._sendJSON({type:"complete"})}return 1}));case 10:case"end":return e.stop()}}),e)})),o=0;case 5:if(!(o<n.length)){e.next=10;break}return e.delegateYield(a(o),"t0",7);case 7:o++,e.next=5;break;case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"_ChunkAndSendEachFile",value:(e=m()(p.a.mark((function e(t){var n,r,s,i,a,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.files,r=!0,s=!1,i=void 0,e.prev=4,a=n[Symbol.iterator]();case 6:if(r=(o=a.next()).done){e.next=14;break}return c=o.value,Pe.chunk(c,this._sendPartialFile),e.next=11,X(window,"file-sent");case 11:r=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),s=!0,i=e.t0;case 20:e.prev=20,e.prev=21,r||null==a.return||a.return();case 23:if(e.prev=23,!s){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),e,this,[[4,16,20,28],[21,,23,27]])}))),function(t){return e.apply(this,arguments)})},{key:"_dcOnMessage",value:function(e){var t=this,n=e.data,r="string"==typeof n?JSON.parse(n):n;if(!C(r))return $e.merge({file:r,data:this._fileMeta},(function(e){return t.__reportProgress(!1,e,t._fileMeta.size)}),Ie.bind(this)),console.log("received chunk"),this._sendJSON({type:"chunk-ready"});var s=r||{},i=s.type,a=s.data;if(i){var o=this._messageHooks[i];if(o)return o(a)}}},{key:"_onUnmount",value:function(){this._socket.close(),this._closeRTCConn()}},{key:"_startConn",value:function(){this._socket.send({type:"init",data:{sess_id:this._sess_id}}),this._socket.onmessage=this._wsOnMessage}},{key:"__updateReport__",value:function(e){return this._reportHook.textContent=e}},{key:"_socketError",value:function(e){return this._content.getRouter().pushStatus(500,e||"Could not Connect to the server")}}]),s}();function Ie(e){this._progressElement&&this._progressElement.remove();var t=new He(URL.createObjectURL(new Blob([e],{type:this._fileMeta.type})),this._fileMeta);document.body.append(t),this._fileMeta=null}var ze={route:"/session",element:"div",idx:"$session",children:[{element:"div",attrs:{id:"reporthooks"}},{element:"button",attrs:{ripple:"",id:"file-send",class:"actionbtn",textContent:"send file",style:"display:none;margin:auto;margin-top:20px"}},{element:"button",attrs:{ripple:"",id:"message-send",class:"actionbtn",textContent:"Send Message",style:"display:none;margin:auto;margin-top:20px"}},{element:"button",attrs:{ripple:"",class:"actionbtn",style:"position:absolute;bottom:10px;padding:6px;left:5px; text-transform: unset;"},events:{click:function(){var e=document.getElementById("logger-area");return"block"!==e.style.display?(e.style.display="block",this.attrs.textContent="hide Logs"):(e.style.display="none",this.attrs.textContent="click to see logs")}},children:["Click to see Logs"]},{element:"textarea",attrs:{readonly:!0,id:"logger-area",style:"resize:none;text-align:justify;display:none;overflow:scroll;height:20%;width:55%;position:absolute;background:#fff;bottom:80px;left:5px"}},{element:"div",attrs:{id:"file-area"}}],onrender:function(e){if(!this.attrs.hasConn)return function(e,t){return Fe.apply(this,arguments)}(e,this)},onUnmount:function(){O.emit("unmount-route")}};function Fe(){return(Fe=m()(p.a.mark((function e(t,n){var r,s,i,a,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.qs,s=te(r)){e.next=4;break}return e.abrupt("return",n.getRouter().pushStatus(500,"Invalid data provided"));case 4:return console.log(s),i=s.id,a=s.device_id,e.next=8,ne.post("/api/verify/",!0,JSON.stringify({sess_id:i}),{"content-type":"application/json"});case 8:return o=e.sent,e.next=11,o.json();case 11:if(!(c=e.sent).success){e.next=16;break}return e.abrupt("return",new Ae(i,a,n));case 16:if(!c.error){e.next=18;break}return e.abrupt("return",n.getRouter().pushStatus(500,"No session exists."));case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}F("https://fonts.googleapis.com/css?family=Open+Sans"),I.registerRoute(ge),I.registerRoute(ze),re(I,!1).then((function(){return I.startLoad()}))}});