!function(e){function t(t){for(var r,a,o=t[0],c=t[1],u=t[2],d=0,h=[];d<o.length;d++)a=o[d],s[a]&&h.push(s[a][0]),s[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);h.length;)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},s={0:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;i.push([23,1]),n()}({12:function(e,t,n){e.exports=function(){return new Worker(n.p+"16f23ab749d1cdf0373a.worker.js")}},13:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);n(13);var r,s=n(5),i=n.n(s),a=n(4),o=n.n(a),c=n(6),u=n.n(c),l=n(7),d=n.n(l),h=n(0),p=n.n(h),f=n(8),v=n.n(f),m=n(1),y=n.n(m),g=n(2),_=n.n(g),k=n(3),x=n.n(k),b=n(9),w=n.n(b),C=function(e){return e.constructor===Object},S=function(e){if("string"==typeof e)return"/"===e[0]?location.hash=e:location.hash="/".concat(e)},R=new(function(){function e(){_()(this,e),this.EventCache={}}return x()(e,[{key:"emit",value:function(e,t){return window.dispatchEvent(new CustomEvent(e,{detail:t}))}},{key:"listen",value:function(e,t){return this.EventCache[e]=t,window.addEventListener(e,t)}},{key:"detroyEvt",value:function(e,t){window.removeEventListener(e,t)}},{key:"destroyAll",value:function(){for(var e=Object.keys(this.EventCache),t=0;t<e.length;t++){var n=e[t];this.detroyEvt(n,this.EventCache[n])}}}]),e}()),T=function(){},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return v()(Array(e)).join(".").replace(/[.]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})},M=((r=document.createElement("style")).innerHTML="",document.head.appendChild(r),r.sheet),O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return Array.from(t.rules).filter(function(t){return t.selectorText===e})[0]},L=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=Object.keys(t),s=0;s<r.length;s++){var i=r[s];if(!["$$element","$$parent"].includes(i)){var a=t[i];if("class"===i)e.className="string"==typeof a?a:v()(a).join(" ");else if("events"===i)for(var o=Object.keys(a),c=0;c<o.length;c++){var u=o[c],l=a[u];e.addEventListener(u,l)}else if("style"===i){var d=void 0,h=void 0,p=void 0;if(d=C(a)?j(a):a,p=e.getAttribute("_routercontent")||t._routercontent){var f=O('[_routercontent="'.concat(p,'"]'));f?f.style=d:h=!0}else p=E(),h=!0;h&&(e.setAttribute("_routercontent",p),n.insertRule("[_routercontent='".concat(p,"']{").concat(d,"}")))}else["___innerHTML___","innerText","textContent"].includes(i)?"___innerHTML___"===i?e.innerHTML=a:e.textContent=a:e.setAttribute(i,a)}}},H={q:function(e){return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?document.querySelector(e):Array.from(document.querySelectorAll(e))},id:function(e){return document.getElementById(e)},className:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Array.from(document.getElementsByClassName(e));return t?n[0]:n},create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=document.createElement(e);return t&&"object"==w()(t)&&L(r,t,n),r},get:function(e,t){return e.getAttribute(t)},set:function(e,t,n){return e.setAttribute(t,n)},empty:function(e){var t;for(t=e.lastChild;t;)e.removeChild(t),t=e.lastChild}},$=function(e){return e instanceof Function},D=function(e){return"AsyncFunction"===e.constructor.name},j=function(e){if("string"==typeof e)return e;for(var t=[],n=Object.keys(e),r=0;r<n.length;r++){var s=n[r];t.push("".concat(s,":").concat(e[s]))}return t.join(";")};var N=function(e){var t=0|e/1048576;if(t)return"".concat(t," MB");var n=0|e/1024;return n?"".concat(n," KB"):"".concat(e," b")},q=function(e,t){if(e){var n=e.routeCache();return n?n[t]:null}return null};function B(e,t){if(!window.customElements.get(e))return window.customElements.define(e,t)}H.q("noscript").remove();var P={element:"a",attrs:{href:"/#/",style:{display:"block",color:"#000"}},events:{click:function(e){e.preventDefault(),location.hash="/"}},textContent:"Click Here to Go Back",children:[]},A={display:"block","text-align":"center","font-family":"sans-serif",padding:"8px",margin:"auto","font-weight":"bold"},I=new(function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.$ROOT||H.id("app-root")||H.q("body");_()(this,e),this._setVars(n),window.onhashchange=function(e){return t.navData=e,t.routeChange(),t._runDirectives()},this._runDirectives()}return x()(e,[{key:"parseHash",value:function(e){return function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location;if("#"===t[0])e=t.substr(1);else try{e=new URL(t).hash.substr(1)}catch(t){e="/",console.log(t)}var n=e.split("?"),r=[0===e.length?"/":n[0],n[1]];return{path:r[0],qs:r[1]}}(e)}},{key:"__runConditionals",value:function(){var e=y()(p.a.mark(function e(){var t,n,r,s,i,a,o,c,u,l,d,h;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=v()(document.querySelectorAll("[_routerif]")),n=!0,r=!1,s=void 0,e.prev=4,i=t[Symbol.iterator]();case 6:if(n=(a=i.next()).done){e.next=27;break}if(o=a.value,c=H.get(o,"_routerif"),u=H.get(o,"_routerthen"),!new Function("$","return ".concat(c)).call(this,o)){e.next=17;break}(l=o.$)&&o.replaceWith(l),u&&new Function("$",u).call(this,l||o),e.next=24;break;case 17:if(!(o.$ instanceof HTMLElement)){e.next=19;break}return e.abrupt("continue",24);case 19:d={_routerif:c},u&&(d._routerthen=u),(h=H.create("router-data",d)).$=o,o.replaceWith(h);case 24:n=!0,e.next=6;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(4),r=!0,s=e.t0;case 33:e.prev=33,e.prev=34,n||null==i.return||i.return();case 36:if(e.prev=36,!r){e.next=39;break}throw s;case 39:return e.finish(36);case 40:return e.finish(33);case 41:case"end":return e.stop()}},e,this,[[4,29,33,41],[34,,36,40]])}));return function(){return e.apply(this,arguments)}}()},{key:"__runEventListeners",value:function(){var e=y()(p.a.mark(function e(){var t,n,r,s,i,a,o,c=this;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=H.q("[_routerEvt][_routerAct]",!1),n=!0,r=!1,s=void 0,e.prev=4,i=function(){var e=o.value,t=H.get(e,"_routerEvt"),n=H.get(e,"_routerAct");e[t]=function(){new Function(n).call(c)}},a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)i();e.next=13;break;case 9:e.prev=9,e.t0=e.catch(4),r=!0,s=e.t0;case 13:e.prev=13,e.prev=14,n||null==a.return||a.return();case 16:if(e.prev=16,!r){e.next=19;break}throw s;case 19:return e.finish(16);case 20:return e.finish(13);case 21:case"end":return e.stop()}},e,this,[[4,9,13,21],[14,,16,20]])}));return function(){return e.apply(this,arguments)}}()},{key:"_runDirectives",value:function(){var e=y()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.__runConditionals();case 2:this.__runEventListeners();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_callFuncWithThis",value:function(e,t,n,r){if(D(e))return e.apply(t,[r]).then(function(e){return n&&(e||{}).stopUpdate&&L(n,t.attrs),e});var s=e.apply(t,[r]);return n&&((s||{}).stopUpdate||L(n,t.attrs)),s}},{key:"_setVars",value:function(e){var t=this;this.stopSubsequentRenders=!1,this.root=e,this.routeMap={},this.routes=[],this.routeCache={},this.unMountFn=function(){},this.unmountRoute=function(){t.unMountFn(),t.routeCache={}},this.statusHandler={404:{element:"div",attrs:{style:A},textContent:"The Page you are requesting was not found",children:[P]},500:{element:"div",attrs:{style:A},textContent:"An Error Occured while trying to process your request",children:[P]}}}}]),x()(e,[{key:"isUserGoingBack",value:function(e){var t=this.navData||{};return!("".concat(location.protocol,"//").concat(location.host,"/#").concat(e)!=t.oldURL||(console.log("Same url navigation"),0))}},{key:"routeParser",value:function(e){return this.parseHash(e).path}},{key:"load",value:function(e){return S(e)}},{key:"lazyload",value:function(e,t,n){var r=this;n?this.registerRoute(n):this.registerRoute({route:e,element:"div",textContent:"loading",attrs:{style:{margin:"100px"}}});var s=this.getRouteName(this.currentRoute)===e;return s&&this.startLoad(),t.then(function(e){if(r.registerRoute(e.default),s)return r.startLoad()})}},{key:"startLoad",value:function(){this.routeChange()}},{key:"pushStatus",value:function(e,t){var n=this.statusHandler[e];return n.textContent=t||n.textContent,n?this.render(n,this.root,!0):this.render(this.statusHandler[404])}},{key:"getRouteName",value:function(e){var t=e.split("/").filter(function(e){return e})[0];return t?"/".concat(t,"/"):"/"}},{key:"isValidRoute",value:function(e){if(this.routes.includes(e))return{res:!0,args:null,_fRoute:e};try{var t=e.split("/").filter(function(e){return e}),n="/".concat(t[0],"/");return this.routes.includes(n)?{res:!0,args:t.slice(1),_fRoute:n}:{res:!1}}catch(t){return console.log(t),{res:!1}}}},{key:"routeChange",value:function(){var e=this.parseHash(location.href),t=this.isValidRoute(e.path),n=t.res,r=t.args,s=t._fRoute;n?(console.log("rendering"),this.render(this.routeMap[s],this.root,!0,{args:r,qs:e.qs})):this.render(this.statusHandler[404],this.root,!0,r)}},{key:"__toSets",value:function(e){"string"==typeof e.attrs.class?e.attrs.class=new Set([e.attrs.class]):Array.isArray(e.attrs.class)&&(e.attrs.class=new Set(e.attrs.class))}},{key:"__objDef",value:function(e,t,n,r,s){var i=this,a=function(){return e.$$element};e.attrs=e.attrs||{},this.__toSets(e),e.getRouter=function(){return i},e.update=function(){if(a()&&e.attrs)return L(a(),e.attrs)},e.remove=function(){if(a().parentNode)return a().replaceWith((t=H.create("router-data"),e._$routerData=t,t));var t},e.add=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";e._$routerData&&(e._$routerData.replaceWith(a()),e._$routerData=void 0),t&&(a().style.display=t)},e.routeCache=function(){return i.routeCache},e.reRender=y()(p.a.mark(function o(){var c,u=arguments;return p.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return c=u.length>0&&void 0!==u[0]?u[0]:e,e.attrs._routercontent=a().getAttribute("_routercontent"),o.t0=a(),o.next=5,i.render(c,t,n,r,s);case 5:return o.t1=o.sent,o.abrupt("return",o.t0.replaceWith.call(o.t0,o.t1));case 7:case"end":return o.stop()}},o,this)})),e.safeRerender=function(t){e.add(),e.reRender(t),e.add()}}},{key:"render",value:function(){var e=y()(p.a.mark(function e(t,n){var r,s,i,a,o,c,u,l,d,h,f,v,m,y,g,_,k,x,b,w,C,S,R,T,E,M,O,L=this,j=arguments;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=j.length>2&&void 0!==j[2]&&j[2],s=j.length>3?j[3]:void 0,i=j.length>4?j[4]:void 0,!this.stopSubsequentRenders&&t){e.next=6;break}return console.log("preventing render"),e.abrupt("return");case 6:if("string"!=typeof t){e.next=9;break}return a=document.createTextNode(t),e.abrupt("return",(n.appendChild(a),a));case 9:if(o=s||{},this._runDirectives(),c=t.element,u=t.attrs,l=t.beforeRender,d=t.onrender,h=t.textContent,f=t._innerHTML,v=t.onUnmount,m=t.events,y=t.children,g=t.isRoute,this.__objDef(t,n,r,o,i),(g||r)&&this.unmountRoute(),!$(l)){e.next=24;break}if(!D(l)){e.next=21;break}return e.next=18,this._callFuncWithThis(l,t,null,o);case 18:_=e.sent,e.next=22;break;case 21:_=this._callFuncWithThis(l,t,null,o);case 22:if(!_||!_.stopExec){e.next=24;break}return e.abrupt("return");case 24:for(k=H.create(c,u),x={},t.idx&&(x[t.idx]=t),Object.assign(this.routeCache,z(y),x),t.$$element=k,t.$$parent=i||null,h||0===h?k.textContent=h:f&&(console.warn("innerHTML can be dangerous!"),k.innerHTML=f),b=Object.keys(m||{}),w=function(){var e=b[C];k.addEventListener(e,function(n){return L._callFuncWithThis(m[e],t,k,n)})},C=0;C<b.length;C++)w();for(S=!0,R=!1,T=void 0,e.prev=37,E=(y||[])[Symbol.iterator]();!(S=(M=E.next()).done);S=!0)O=M.value,this.render(O,k,!1,null,t);e.next=45;break;case 41:e.prev=41,e.t0=e.catch(37),R=!0,T=e.t0;case 45:e.prev=45,e.prev=46,S||null==E.return||E.return();case 48:if(e.prev=48,!R){e.next=51;break}throw T;case 51:return e.finish(48);case 52:return e.finish(45);case 53:if(r&&H.empty(n),n.appendChild(k),g&&(this.unMountFn=v||function(){}),!$(d)){e.next=63;break}if(!D(d)){e.next=62;break}return e.next=60,this._callFuncWithThis(d,t,k,o);case 60:e.next=63;break;case 62:this._callFuncWithThis(d,t,k,o);case 63:return e.abrupt("return",k);case 64:case"end":return e.stop()}},e,this,[[37,41,45,53],[46,,48,52]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"registerRoute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(e.route&&e.element&&"/"===e.route[0]||t))throw new Error("invalid values");if(!t){this.routes.includes(e.route)||this.routes.push(e.route);var n=e.element,r=e.children,s=e.selector,i=e.attrs,a=e.beforeRender,o=e.events,c=e.hasRouteArgs,u=e.onUnmount,l=e.onrender,d=e.route,h=e.textContent,p=e._innerHTML,f=e.idx;return this.routeMap[d]={idx:f,element:n,selector:s,beforeRender:a,onrender:l,hasRouteArgs:c,attrs:i,textContent:h,_innerHTML:p,events:o,children:r,onUnmount:u,isRoute:!0}}var v=e.status;this.statusHandler[v]=e}},{key:"currentQS",get:function(){return this.parseHash(location.hash).qs}},{key:"currentRoute",get:function(){return this.routeParser(location.href)}}]),e}());function z(e){if(!e)return{};var t={},n=!0,r=!1,s=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var o=i.value;o.idx&&(t[o.idx]=o)}}catch(e){r=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return t}B("router-data",function(e){function t(){var e;return _()(this,t),(e=i()(this,o()(t).call(this))).attachShadow({mode:"open"}).appendChild(Object.assign(document.createElement("style"),{innerHTML:":host{display:none}"})),e}return u()(t,e),t}(d()(HTMLElement)));var F,J=function(){var e=y()(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",((n=document.createElement("link")).href=t,n.rel="stylesheet",document.head.appendChild(n)));case 4:e.prev=4,e.t0=e.catch(0),console.log("Could not append stylesheet",e.t0);case 7:case"end":return e.stop()}},e,this,[[0,4]])}));return function(t){return e.apply(this,arguments)}}(),U=n(10),W=n.n(U),V=(F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s={};return t.blur||(s.blur=function(){(function(e,t){if(!e.attrs.value||!e.attrs.value.trim()){var n=q(e,t);n.attrs.class.delete("moveup"),n.attrs.class.add("movedown"),n.update(),setTimeout(function(){return n.attrs.class.delete("movedown"),n.update()},110)}})(this,r),this.update()}),t.focus||(s.focus=function(){var e;this.attrs.untouched=!1,(e=q(this,r)).attrs.class.add("moveup"),e.attrs.class.delete("movedown"),e.update()},!t.keydown&&(s.keydown=function(e){85===e.keyCode&&e.ctrlKey&&(e.preventDefault(),this.$$element.value=this.$$element.value.slice(this.$$element.selectionStart,this.$$element.value.length),this.$$element.setSelectionRange(0,0))}),!t.keyup&&(s.keyup=function(){return this.attrs.value=this.$$element.value})),{idx:e,element:"input",attrs:{type:n?"password":"text",spellcheck:!1,class:"paper-input"},onrender:function(){this.attrs.value?this.$$element.focus():(this.attrs.untouched=!0,this.attrs.clean=!0)},events:W()({},t,s)}},function(e,t,n,r){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return{element:"div",children:[{idx:e,onrender:function(){var e=q(this,n);e&&e.$$element&&e.$$element.value.trim()&&(this.attrs.class=new Set(["_animate","moveup"]))},element:"div",textContent:t,attrs:{class:"_animate"}},F(n,r,s,e)]}}),G=function(e){function t(e,n,r,s){var a;_()(this,t);var c=(a=i()(this,o()(t).call(this))).createTemplate();return a.attachShadow({mode:"open"}).appendChild(c.content.cloneNode(!0)),a.svg=function(){return a.shadowRoot.querySelector("svg")},a.circle=function(){return a.shadowRoot.querySelector("circle")},e&&(a.size=e),n&&(a.color=n),r&&(a.svg().style=r),s&&(a.circle().style=s),a}return u()(t,e),x()(t,[{key:"attributeChangedCallback",value:function(e,t,n){"size"===e?this.size=n:"color"===e?this.color=n:"svgstyle"===e?this.svgstyle=n:"circlestyle"===e&&(this.circlestyle=n)}},{key:"createTemplate",value:function(){var e=H.create("svg",{viewbox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"}),t=H.create("circle",{fill:"none","stroke-width":6,"stroke-linecap":"round",cx:33,cy:33,r:30}),n=document.createElement("template");e.appendChild(t);var r=document.createElement("style");return r.innerHTML="svg{display:inline-block;width: 65px;height: 65px;animation:rotator 1.4s linear infinite}@keyframes rotator{0%{transform:rotate(0)}100%{transform:rotate(270deg)}}circle{stroke:#6f70ee;stroke-dasharray:120;stroke-dashoffset:0;transform-origin:center;animation:dash 1.4s ease-in-out infinite}@keyframes dash{0%{stroke-dashoffset:120}50%{stroke-dasharray:200;stroke-dashoffset:190;transform:rotate(135deg)}100%{stroke-dashoffset:120;transform:rotate(450deg)}}",n.innerHTML=r.outerHTML+e.outerHTML,n}},{key:"size",set:function(e){var t=this.svg();t.style.height=t.style.width=e},get:function(){return this.svg().style.height}},{key:"color",set:function(e){this.circle().style.stroke=e},get:function(){return this.circle().style.stroke}},{key:"svgstyle",set:function(e){return this.svg().style=e}},{key:"circlestyle",set:function(e){return this.circle().style=e}}],[{key:"observedAttributes",get:function(){return["size","color","svgstyle","circlestyle"]}}]),t}(d()(HTMLElement));B("mat-spinner",G);var K=window.location.host.includes("localhost")?"localhost:5000":"file-share-rtc.herokuapp.com";function Q(e,t){return new Promise(function(n){e.addEventListener(t,n,{once:!0})})}var Y="".concat(window.location.protocol,"//").concat(K),X=function(e){try{return btoa(JSON.stringify(e))}catch(e){return console.warn(e),null}},Z=function(e){try{return JSON.parse(atob(e))}catch(e){return console.warn(e),null}},ee=function(){function e(){_()(this,e)}return x()(e,null,[{key:"get",value:function(){var e=y()(p.a.mark(function e(t){var n,r,s,i=arguments;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],r=i.length>2&&void 0!==i[2]?i[2]:{},s=n?Y+t:t,e.next=5,fetch(s,{headers:r,credentials:"include"});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=y()(p.a.mark(function e(t){var n,r,s,i,a=arguments;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],r=a.length>2?a[2]:void 0,s=a.length>3&&void 0!==a[3]?a[3]:{"content-type":"application/x-www-form-urlencoded"},i=n?Y+t:t,e.next=6,fetch(i,{method:"post",body:r,headers:s,credentials:"include"});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}();function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=y()(p.a.mark(function e(t,n){var r,s,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){var e=y()(p.a.mark(function e(){var n,r=arguments;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(r.length>0&&void 0!==r[0])||r[0],t.stopSubsequentRenders=!1,H.empty(t.root),t.root.appendChild(new G(null,null,j({margin:"auto",position:"fixed",top:0,bottom:0,left:0,right:0}))),t.root.appendChild((s=void 0,(s=H.create("div",{style:"margin:auto;text-align:center"})).textContent="Connecting to the server",s)),e.next=7,ee.get("/api/gen_204");case 7:setTimeout(function(){return n?t.startLoad():void 0},450);case 8:case"end":return e.stop()}var s},e,this)}));return function(){return e.apply(this,arguments)}}(),s=function(e){return{element:"div",status:503,textContent:"An error occured while contacting the server..please reload the page and try again",attrs:{style:{margin:"auto","text-align":"center"},class:"_errComponent"},children:[{element:"button",attrs:{style:{background:"#fff",color:"#000",border:"1px solid #6f70ee","border-radius":"20px",display:"block",margin:"auto","margin-top":"20px",padding:"8px",width:"20%",outline:"none",cursor:"pointer"},class:"ripple"},textContent:"Reload",events:{click:function(){return te(e)}}}]}},i=function(e,t){return console.log(e),t.registerRoute(s(t),!0),setTimeout(function(){return t.pushStatus(503),t.stopSubsequentRenders=!0},500)},e.abrupt("return",re(function(){return r(n)},2,function(e){return i(e,t)}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var re=function(){var e=y()(p.a.mark(function e(t,n,r){var s,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<n)){e.next=16;break}return e.prev=2,e.next=5,t();case 5:return e.abrupt("return",e.sent);case 8:e.prev=8,e.t0=e.catch(2),s=e.t0;case 11:return e.next=13,new Promise(function(e){setTimeout(function(){return e()},100)});case 13:i++,e.next=1;break;case 16:r(s);case 17:case"end":return e.stop()}},e,this,[[2,8]])}));return function(t,n,r){return e.apply(this,arguments)}}(),se="".concat(navigator.platform,"-").concat(navigator.product,"-").concat(E(5)),ie={element:"div",onrender:function(){var e=q(this,"deviceID"),t=q(this,"deviceID-ph");t.attrs.class.add("moveup"),e.attrs.value=se,e.reRender(),t.reRender()},children:["Type Your Device Name",V("deviceID-ph","Device Name","deviceID")]};function ae(e,t){var n=q(t,"notif");return n.$$element.style.transform="translate(0px,0px)",n.$$element.textContent=e,setTimeout(function(){return n.reRender()},2e3)}function oe(e,t){return ce.apply(this,arguments)}function ce(){return(ce=y()(p.a.mark(function e(t,n){var r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q(n,"$spinner").add(),e.next=4,ee.post("/api/validate-id/",!0,JSON.stringify({sess_id:t}),{"content-type":"application/json"});case 4:return r=e.sent,e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function ue(){return(ue=y()(p.a.mark(function e(t){var n,r,s,i,a,o,c,u,l;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.keyCode,r=this.attrs.value||"",!(s=r.trim())||13!==n){e.next=34;break}return e.next=6,oe(s,this);case 6:if("unique"!==e.sent.type){e.next=11;break}ae("No Session exists with the given ID",this),e.next=33;break;case 11:return i=q(this,"deviceID").attrs.value,e.next=14,ee.post("/api/get-id/",!0,JSON.stringify({sess_id:s,device_id:i,default_token:se}),{"content-type":"application/json"});case 14:return a=e.sent,e.next=17,a.json();case 17:if(o=e.sent,!((u=o.init_conn).length-1)){e.next=25;break}return e.next=22,getPreferredUser();case 22:c=e.sent,e.next=26;break;case 25:c=u[0];case 26:if("no_id"!==o.type){e.next=30;break}return e.abrupt("return",ae("An error occured while connecting..please start a new session",this));case 30:if(!(l=X({id:s,device_id:i,preferred:c}))){e.next=33;break}return e.abrupt("return",S("/session?".concat(l)));case 33:return e.abrupt("return",q(this,"$spinner").remove());case 34:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function le(e){return de.apply(this,arguments)}function de(){return(de=y()(p.a.mark(function e(t){var n,r,s,i,a,o;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.keyCode,r=this.attrs.value||"",!(s=r.trim())||13!==n){e.next=26;break}return e.next=6,oe(s,this);case 6:if("unique"!==e.sent.type){e.next=24;break}return i=q(this,"deviceID").attrs.value,e.next=11,ee.post("/api/set-id/",!0,JSON.stringify({sess_id:s,device_id:i,default_token:se}),{"content-type":"application/json"});case 11:return a=e.sent,e.next=14,a.json();case 14:if("init_connection"!==e.sent.type){e.next=21;break}if(!(o=X({id:s,device_id:i}))){e.next=19;break}return e.abrupt("return",S("/session?".concat(o)));case 19:e.next=22;break;case 21:ae("Invalid Data",this);case 22:e.next=25;break;case 24:ae("A Session already exists with that name",this);case 25:return e.abrupt("return",q(this,"$spinner").remove());case 26:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var he={idx:"startsessbtn",element:"button",attrs:{style:{"border-radius":"5px",margin:"10px"},class:["ripple","actionbtn"]},children:["Start a Session"],events:{click:function(){var e=q(this,"joinSessBox"),t=q(this,"startSessBox");e.remove(),t.add("")}}},pe={idx:"joinsessbtn",element:"button",attrs:{style:{"border-radius":"5px",margin:"10px"},class:["ripple","actionbtn"]},children:["Join a Session"],events:{click:function(){var e=q(this,"joinSessBox"),t=q(this,"startSessBox");e.add(""),t.remove()}}},fe={idx:"joinSessBox",onrender:function(){this.remove()},element:"div",children:[{element:"div",children:["Type a session name to join"]},V("joinID-ph","Session ID","joinID",{keydown:function(e){return ue.apply(this,arguments)}})]};console.log(V("startID-ph","Session ID","startID",{keydown:le}));var ve,me={route:"/",element:"div",attrs:{},children:[{element:"div",idx:"notif",attrs:{notification:""}},ie,he,pe,fe,{onrender:function(){this.remove()},children:[{element:"div",children:["Type a session name to start. Others will find your device with this name"]},V("startID-ph","Session ID","startID",{keydown:le})],idx:"startSessBox",element:"div"},{element:"mat-spinner",idx:"$spinner",onrender:function(){this.remove()},attrs:{svgstyle:"margin:auto;display:block"}}]},ye=function(){function e(){_()(this,e)}return x()(e,[{key:"__defaultOnMessage",value:function(e){if(!["ping","pong"].includes(e.data)){var t=JSON.parse(e.data);this._socketID=t.socket_id}}},{key:"startConn",value:function(e){var t=this;return new Promise(function(n,r){var s;t.socket=new WebSocket((s=e,"".concat("https:"===window.location.protocol?"wss://":"ws://").concat(K,"/").concat(s))),t.socket.onopen=function(){t.socket.onmessage=t.__defaultOnMessage,t._pingPongs(),n(t.socket)},t.socket.onerror=function(e){return r(e)}})}},{key:"close",value:function(){try{this.socket.close()}catch(e){console.warn(e)}}},{key:"send",value:function(e){return this.socket.send(JSON.stringify(e))}},{key:"sendString",value:function(e){return this.socket.send(e)}},{key:"_pingPongs",value:function(){var e=this;this.pingtimer=setTimeout(function(){e.socket.readyState===e.socket.OPEN?(e.send({type:"ping"}),e._pingPongs()):clearTimeout(e.pingtimer)},2e4)}},{key:"onmessage",set:function(e){this.socket.onmessage=function(t){var n=JSON.parse(t.data||"{}");return"ping"===n.type||"pong"===n.type?void 0:e(n)}}},{key:"readyState",get:function(){return this.socket.readyState}},{key:"isUsable",get:function(){return!this.socket||[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)}}]),e}(),ge=function(){return(ve||{}).isUsable?ve:ve=new ye},_e="div[full]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.61);z-index:10;padding:16px}div[header],input{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}div[header]{font-weight:700;user-select:none}div[message],div[area]{-webkit-box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);z-index:3;background:#fff;border-radius:8px;width:100%;padding:16px;max-width:500px}input,span{display:inline-block}input{user-select:none;background-color:#f5f5f5;padding:12px;margin-top:20px;margin-bottom:20px;width:95%;border:none;outline:0;border-radius:50px}span:hover{background-color:#d2d2d2}span{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:60px;text-align:center;padding:6px;cursor:pointer;border-radius:8px;color:var(--primary-color)}";var ke,xe=n(12),be=new(n.n(xe).a),we=(ke={_handlers:{},worker:null},new(function(){function e(t){_()(this,e),ke.worker=t,this.onmessage=this.onmessage.bind(this),ke.worker.onmessage=this.onmessage}return x()(e,[{key:"setHandler",value:function(e,t){ke._handlers[e]=t}},{key:"onmessage",value:function(e){var t=e.data,n=t.type,r=t.data,s=ke._handlers[n];if(s)return s(r);console.log("Worker Said:",r)}},{key:"handlers",get:function(){return ke._handlers}}]),e}())(be)),Ce=function(){var e=y()(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Response(t).arrayBuffer();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),Se=function(){function e(){_()(this,e),this.chunkBuffer=this.chunkBuffer.bind(this),this._buffer=[]}return x()(e,[{key:"chunkBuffer",value:function(e){this._buffer.push(e.fileChunk),e.over&&this._fn({bufferChunk:this._buffer,data:this._meta})}},{key:"chunk",value:function(){var e=y()(p.a.mark(function e(t,n){var r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._buffer=[],this._fn=n,e.next=4,Ce(t);case 4:r=e.sent,this._meta={type:t.type,name:t.name,size:t.size,id:E(15)},be.postMessage({data:W()({file:r},this._meta),type:"file-chunk"},[r]),we.setHandler("chunked-file",this.chunkBuffer);case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),Re=function(){function e(){var t=this;_()(this,e),this.mergeBuffer=this.mergeBuffer.bind(this),this._buffer=[],this._currentBufferByteSize=0,we.setHandler("merged-file",this.mergeBuffer),we.setHandler("merge-progress",function(e){var n=e.done;return t._currentBufferByteSize=n})}return x()(e,[{key:"mergeBuffer",value:function(e){var t=this;console.log("final File:"),Promise.resolve(this._onFullFile(e)).then(function(){return t._buffer=[],t._currentBufferByteSize=0})}},{key:"merge",value:function(){var e=y()(p.a.mark(function e(t,n,r){var s,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=t.file,i=t.data,this._onFullFile=r,this._meta=i,Promise.resolve(this._currentBufferByteSize).then(n||T),be.postMessage({data:s,type:"file-merge"},[s]);case 5:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"complete",value:function(){be.postMessage({type:"complete",data:this._meta})}}]),e}(),Te="<style>div[area],span{border-radius:8px}div[full]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.61);z-index:10;padding:16px}div[area]{-webkit-box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.4);z-index:3;background:#fff;width:100%;padding:16px;max-width:500px}div[header]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;font-weight:700;user-select:none}div[progress]{margin:auto;transition:0.2s;height:20px;background-color:var(--primary-color);border-radius:20px;}span{display:inline-block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:60px;text-align:center;padding:6px;cursor:pointer;color:var(--primary-color)}</style>",Ee=function(e){function t(e,n,r){var s;_()(this,t),(s=i()(this,o()(t).call(this)))._done=e||0,s._total=n||100,s._str=r||"";var a="".concat(Te,"<div full><div area><div header></div><div progress></div><div><span progress-text></span></div></div></div>"),c=document.createElement("template");c.innerHTML=a;var u=s.attachShadow({mode:"open"});return u.appendChild(c.content.cloneNode(!0)),s._header=u.querySelector("div[header]"),s._progressDiv=u.querySelector("div[progress]"),s._progressText=u.querySelector("span[progress-text]"),s}return u()(t,e),x()(t,[{key:"connectedCallback",value:function(){this._render()}},{key:"_render",value:function(){this._header.textContent=this._str;var e=(this._done/this._total*100).toFixed(2),t="".concat(Math.min(e,100),"%");this._progressDiv.style.width=t,this._progressText.textContent="".concat(t," ").concat(N(this._done)," of ").concat(N(this._total))}},{key:"setValues",value:function(e,t,n){this._total=t,this._done=e,this._str=n,this._render()}}]),t}(d()(HTMLElement)),Me=Ee,Oe=function(e){function t(e,n){var r;_()(this,t),r=i()(this,o()(t).call(this));var s="".concat(Te,"<div full><div area><div header></div><div download></div><div size></div><span cancel>Cancel</span><span download>Download</span></div></div>");r._url=e;var a=document.createElement("template");a.innerHTML=s;var c=r.attachShadow({mode:"open"});return c.appendChild(a.content.cloneNode(!0)),r._header=c.querySelector("div[header]"),r._download=c.querySelector("div[download]"),r.__size=c.querySelector("div[size]"),r.dlButton=c.querySelector("span[download]"),r.cancelBTN=c.querySelector("span[cancel]"),c.querySelector("div[area]").onclick=function(e){return e.stopPropagation()},r._meta=n||{},r}return u()(t,e),x()(t,[{key:"connectedCallback",value:function(){var e=this;this._header.textContent="Download Ready",this._download.textContent="Filename:".concat(this._meta.name),this.__size.textContent="Size:".concat(N(this._meta.size)),this.cancelBTN.onclick=function(){return e.remove()},this.dlButton.onclick=function(){var t=document.createElement("a");t.href=e._url,t.download=e._meta.name,t.click(),e.remove()}}}]),t}(d()(HTMLElement));var Le=new Se,He=new Re;function $e(){try{for(var e=document.getElementById("logger-area"),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var s=0;s<n.length;s++){var i=n[s];e.appendChild(document.createTextNode(C(i)?JSON.stringify(i):i))}return e.innerHTML+="&#13;&#10;",console.log.apply(this,n)}catch(e){}}B("file-download",Oe),B("file-progress",Ee),B("text-input",function(){var e={onsend:null,innerHTML:"<style>".concat(_e,'</style><div full><div area><div header>Send a Message</div><input spellcheck="false" placeholder="Send a Message" type="text"><span send-button>Send</span><span cancel-button>Cancel</span></div></div>')};return function(t){function n(){var t;_()(this,n),t=i()(this,o()(n).call(this));var r=document.createElement("template");r.innerHTML=e.innerHTML;var s=t.attachShadow({mode:"open"});return s.appendChild(r.content.cloneNode(!0)),s.querySelector("div[area]").onclick=function(e){return e.stopPropagation()},s.querySelector("div[full]").onclick=function(){return t.remove()},e.input=s.querySelector("input"),t.focus=function(){return e.input.focus()},e.input.addEventListener("keydown",function(e){13===e.keyCode&&t.onsend&&t.onsend(t.value)}),s.querySelector("span[cancel-button]").onclick=function(){return t.remove()},t}return u()(n,t),x()(n,[{key:"value",get:function(){return e.input.value},set:function(t){return e.input.value=t}},{key:"onsend",set:function(t){var n=this;e.onsend=t,this.shadowRoot.querySelector("span[send-button]").addEventListener("click",function(){return t(n.value)})},get:function(){return e.onsend}}]),n}(d()(HTMLElement))}()),B("text-received",function(){var e={innerHTML:"<style>".concat(_e,"</style><div full><div message><div header>Received Message</div><input message-content readonly><span>Okay</span></div>")};return function(t){function n(t){var r;_()(this,n),r=i()(this,o()(n).call(this));var s=document.createElement("template");s.innerHTML=e.innerHTML;var a=r.attachShadow({mode:"open"});return a.appendChild(s.content.cloneNode(!0)),e.message=a.querySelector("input[message-content]"),e.message.value=t||"",a.querySelector("div[message]").onclick=function(e){return e.stopPropagation()},a.querySelector("span").onclick=a.querySelector("div[full]").onclick=function(){return r.remove()},r}return u()(n,t),x()(n,[{key:"data",set:function(t){e.message.value=t||this.data||""},get:function(){return e.message.value}}]),n}(d()(HTMLElement))}());var De={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]};function je(e,t){var n=H.create("div",{notification:"",textContent:e});return document.body.appendChild(n),setTimeout(function(){return n.style.transform="translate(0px,0px)",setTimeout(function(){return n.remove()},t||2e3)},300)}var Ne=function(){function e(t,n,r){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ge();_()(this,e),R.listen("unmount-route",this._onUnmount),this._sess_id=t,this._peer=n,this._content=r,this._socket=s,this._isOfferer=void 0,this._reportHook=document.getElementById("reporthooks"),this.__reportProgress=this.__reportProgress.bind(this),this._dcOnMessage=this._dcOnMessage.bind(this),this._ondatachannel=this._ondatachannel.bind(this),this._wsOnMessage=this._wsOnMessage.bind(this),this._onUnmount=this._onUnmount.bind(this),this._sendJSON=this._sendJSON.bind(this),this._startConn=this._startConn.bind(this),this._socketError=this._socketError.bind(this),this._sendPartialFile=this._sendPartialFile.bind(this),this._socket.startConn("socket-conn/").then(this._startConn).catch(),this._messageHooks={"chunk-ready":function(e){return R.emit("chunk-ready",e)}}}return x()(e,[{key:"_closeRTCConn",value:function(){try{return this._pc.close()}catch(e){}this._pc=this._dc=null}},{key:"_onIceCandidate",value:function(e){if(e&&this._pc)return this._socket.send({type:"rtc_data",data:{icecandidate:e,sess_id:this._sess_id}})}},{key:"_iceStateChange",value:function(){var e=y()(p.a.mark(function e(){var t,n,r,s,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this._pc.iceConnectionState,["closed","disconnected","failed"].includes(t)&&($e("Connection is Dead.."),(n=document.querySelector("file-progress"))&&n.remove(),(r=document.querySelector("file-download"))&&r.remove(),s=document.getElementById("file-send"),i=document.getElementById("message-send"),s&&(i.style.display="none",s.style.display="none"),this.__updateReport__("Connection is dead"),je("connection lost.retrying"),this._pc=this._isOfferer=null);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_wsOnMessage",value:function(){var e=y()(p.a.mark(function e(t){var n,r,s,i,a,o,c,u=this;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($e("[WS]",t),n=t.type,r=t.data,s=void 0===r?{}:r,"conn_data"!==n){e.next=29;break}if(this._pc&&($e("[DEBUG]Removing previous connection"),this.__updateReport__("removing previous connection")),this._closeRTCConn(),this._pc=this._dc=this._isOfferer=null,!s.peer||!s.peer_device||this._pc){e.next=27;break}if(this._pc=new RTCPeerConnection(De),this._pc.onicecandidate=function(e){var t=e.candidate;return $e("[RTC]Ice Candidate"),u.__updateReport__("received ice candidate"),u._onIceCandidate(t)},this._pc.oniceconnectionstatechange=function(e){return u._iceStateChange(e)},this._isOfferer=s.is_offerer,!this._isOfferer){e.next=24;break}return $e("[RTC]creating offer"),this.__updateReport__("creating offer"),this._dc=this._pc.createDataChannel(E()),this._dc.onmessage=function(e){if("init"===e.data)return $e("[RTC]Data Channel Ready",u._dc),u.__updateReport__("data channel ready!"),u._startMainSess()},e.next=18,this._pc.createOffer();case 18:return i=e.sent,e.next=21,this._pc.setLocalDescription(i);case 21:return e.abrupt("return",this._socket.send({type:"rtc_data",data:{rtc:"offer",js:i,sess_id:this._sess_id}}));case 24:return $e("[RTC]awaiting offer"),this.__updateReport__("Waiting offer"),e.abrupt("return",this._pc.ondatachannel=function(e){var t=e.channel;return u._ondatachannel(t)});case 27:e.next=65;break;case 29:if("rtc_data"!==n){e.next=65;break}if(a=s.rtc,o=s.js,!(c=s.icecandidate)||!this._pc){e.next=44;break}return e.prev=32,$e("[RTC]Recieved Candidate"),this.__updateReport__("received candidate"),e.next=37,this._pc.addIceCandidate(c);case 37:return e.abrupt("return",e.sent);case 40:e.prev=40,e.t0=e.catch(32),$e("[RTC]Could not add ice candidate"),this.__updateReport__("could not add ice candidate");case 44:if("offer"!==a||this._isOfferer){e.next=60;break}return $e("[RTC]Recieved offer"),this.__updateReport__("recieved offer"),e.next=49,this._pc.setRemoteDescription(o);case 49:return $e("[RTC]Creating Answer"),this.__updateReport__("creating answer"),e.t1=this._pc,e.next=54,this._pc.createAnswer();case 54:return e.t2=e.sent,e.next=57,e.t1.setLocalDescription.call(e.t1,e.t2);case 57:return e.abrupt("return",this._socket.send({type:"rtc_data",data:{rtc:"answer",js:this._pc.localDescription,sess_id:this._sess_id}}));case 60:if("answer"!==a){e.next=65;break}return $e("[RTC]Received Answer"),this.__updateReport__("Received answer"),e.next=65,this._pc.setRemoteDescription(o);case 65:case"end":return e.stop()}},e,this,[[32,40]])}));return function(t){return e.apply(this,arguments)}}()},{key:"_ondatachannel",value:function(e){return this._dc=e,this._sendRaw("init"),$e("[RTC] Recieved Data Channel",e),this.__updateReport__("data channel ready!"),this._startMainSess()}},{key:"_sendRaw",value:function(e){if(this._dc)return this._dc.send(e)}},{key:"_sendJSON",value:function(e){return this._sendRaw(JSON.stringify(e))}},{key:"__reportProgress",value:function(e,t,n){var r="".concat(e?"sending":"receiving"," File");this._progressElement=this._progressElement||new Me(0,0,r),this._progressElement.isConnected||this._content.$$element.appendChild(this._progressElement),this._progressElement.setValues(t,n,r)}},{key:"_startMainSess",value:function(){var e=this;this._reportHook.textContent="Connected to ".concat(this._peer),this._dc.onmessage=this._dcOnMessage,this._messageHooks["file-chunk"]=function(t){e._fileMeta=t,console.log("ready for next chunk"),e._sendJSON({type:"chunk-ready",data:t})},this._messageHooks.complete=He.complete.bind(He);var t=document.getElementById("file-send"),n=document.getElementById("message-send");t.style.display="block",n.style.display="block",n.onclick=function(){return t=function(t){return e._sendJSON({type:"text-message",data:t})},n=H.create("text-input"),document.body.appendChild(n),n.focus(),void(n.onsend=function(e){e.trim()&&(n.value="",n.remove(),t(e))});var t,n},t.onclick=function(){var t=Object.assign(document.createElement("input"),{multiple:"true",type:"file"});return t.oninput=function(){return new Promise(function(n){return n(e._ChunkAndSendEachFile(t))})},t.click()},this._messageHooks["text-message"]=function(e){console.log("[RTC]Received message->",e);var t=document.createElement("text-received");return t.data=e,document.body.appendChild(t)}}},{key:"_sendPartialFile",value:function(e){var t=this,n=e.bufferChunk,r=e.data,s=n.length,i=0;n.forEach(function(){var e=y()(p.a.mark(function e(n,a){var o,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._sendJSON({type:"file-chunk",data:r}),e.next=3,Q(window,"chunk-ready");case 3:if(o=e.sent,o.detail.id!==r.id){e.next=15;break}return t._sendRaw(n),e.next=9,Q(window,"chunk-ready");case 9:if(i+=n.byteLength,t.__reportProgress(!0,i,r.size),a!==s-1){e.next=15;break}return(c=document.querySelector("file-progress"))&&(c.onclick=function(){return c.remove()}),e.abrupt("return",t._sendJSON({type:"complete"}));case 15:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}())}},{key:"_ChunkAndSendEachFile",value:function(){var e=y()(p.a.mark(function e(t){var n,r,s,i,a,o,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.files,r=!0,s=!1,i=void 0,e.prev=4,a=n[Symbol.iterator]();!(r=(o=a.next()).done);r=!0)c=o.value,Le.chunk(c,this._sendPartialFile);e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),s=!0,i=e.t0;case 12:e.prev=12,e.prev=13,r||null==a.return||a.return();case 15:if(e.prev=15,!s){e.next=18;break}throw i;case 18:return e.finish(15);case 19:return e.finish(12);case 20:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19]])}));return function(t){return e.apply(this,arguments)}}()},{key:"_dcOnMessage",value:function(e){var t=this,n=e.data,r="string"==typeof n?JSON.parse(n):n;if(!C(r))return He.merge({file:r,data:this._fileMeta},function(e){return t.__reportProgress(!1,e,t._fileMeta.size)},function(e){this._progressElement&&this._progressElement.remove();var t=new Oe(URL.createObjectURL(new Blob([e],{type:this._fileMeta.type})),this._fileMeta);document.body.append(t),this._fileMeta=null}.bind(this)),this._sendJSON({type:"chunk-ready"});var s=r||{},i=s.type,a=s.data;if(i){var o=this._messageHooks[i];if(o)return o(a)}}},{key:"_onUnmount",value:function(){this._socket.close(),this._closeRTCConn()}},{key:"_startConn",value:function(){this._socket.send({type:"init",data:{sess_id:this._sess_id}}),this._socket.onmessage=this._wsOnMessage}},{key:"__updateReport__",value:function(e){return this._reportHook.textContent=e}},{key:"_socketError",value:function(e){return this._content.getRouter().pushStatus(500,e||"Could not Connect to the server")}}]),e}();var qe={route:"/session",element:"div",idx:"$session",children:[{element:"div",attrs:{id:"reporthooks"}},{element:"button",attrs:{ripple:"",id:"file-send",class:"actionbtn",textContent:"send file",style:"display:none;margin:auto;margin-top:20px"}},{element:"button",attrs:{ripple:"",id:"message-send",class:"actionbtn",textContent:"Send Message",style:"display:none;margin:auto;margin-top:20px"}},{element:"button",attrs:{ripple:"",class:"actionbtn",style:"position:absolute;bottom:10px;padding:6px;left:5px; text-transform: unset;"},events:{click:function(){var e=document.getElementById("logger-area");return"block"!==e.style.display?(e.style.display="block",this.attrs.textContent="hide Logs"):(e.style.display="none",this.attrs.textContent="click to see logs")}},children:["Click to see Logs"]},{element:"textarea",attrs:{readonly:!0,id:"logger-area",style:"resize:none;text-align:justify;display:none;overflow:scroll;height:20%;width:55%;position:absolute;background:#fff;bottom:80px;left:5px"}},{element:"div",attrs:{id:"file-area"}}],onrender:function(e){if(!this.attrs.hasConn)return function(e,t){return Be.apply(this,arguments)}(e,this)},onUnmount:function(){R.emit("unmount-route")}};function Be(){return(Be=y()(p.a.mark(function e(t,n){var r,s,i,a,o,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.qs,s=Z(r)){e.next=4;break}return e.abrupt("return",n.getRouter().pushStatus(500,"Invalid data provided"));case 4:return console.log(s),i=s.id,a=s.device_id,e.next=8,ee.post("/api/verify/",!0,JSON.stringify({sess_id:i}),{"content-type":"application/json"});case 8:return o=e.sent,e.next=11,o.json();case 11:if(!(c=e.sent).success){e.next=16;break}return e.abrupt("return",new Ne(i,a,n));case 16:if(!c.error){e.next=18;break}return e.abrupt("return",n.getRouter().pushStatus(500,"No session exists."));case 18:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}J("https://fonts.googleapis.com/css?family=Open+Sans"),I.registerRoute(me),I.registerRoute(qe),te(I,!1).then(function(){return I.startLoad()})}});